/*! controltag - v5.41.0 - git 881417b - 2015-01-29 10:45:25 */
!function(){var a,b;!function(){var c=this,d={};a=function(b,c){a[b]=c},b=function(e){if(b[e]===d)throw"Circular require: "+e;if(!a[e])throw"Unknown require: "+e;return b[e]||(b[e]=d)&&(b[e]=new function(){return a[e](this,b,c)||this})}}(),a("hogan-3",function(a,b,c){var d={};!function(a){function b(a,b,c){var d;return b&&"object"==typeof b&&(void 0!==b[a]?d=b[a]:c&&b.get&&"function"==typeof b.get&&(d=b.get(a))),d}function c(a,b,c,d,e,f){function g(){}function h(){}g.prototype=a,h.prototype=a.subs;var i,j=new g;j.subs=new h,j.subsText={},j.buf="",d=d||{},j.stackSubs=d,j.subsText=f;for(i in b)d[i]||(d[i]=b[i]);for(i in d)j.subs[i]=d[i];e=e||{},j.stackPartials=e;for(i in c)e[i]||(e[i]=c[i]);for(i in e)j.partials[i]=e[i];return j}function d(a){return String(null===a||void 0===a?"":a)}function e(a){return a=d(a),k.test(a)?a.replace(f,"&amp;").replace(g,"&lt;").replace(h,"&gt;").replace(i,"&#39;").replace(j,"&quot;"):a}a.Template=function(a,b,c,d){a=a||{},this.r=a.code||this.r,this.c=c,this.options=d||{},this.text=b||"",this.partials=a.partials||{},this.subs=a.subs||{},this.buf=""},a.Template.prototype={r:function(){return""},v:e,t:d,render:function(a,b,c){return this.ri([a],b||{},c)},ri:function(a,b,c){return this.r(a,b,c)},ep:function(a,b){var d=this.partials[a],e=b[d.name];if(d.instance&&d.base==e)return d.instance;if("string"==typeof e){if(!this.c)throw new Error("No compiler available.");e=this.c.compile(e,this.options)}if(!e)return null;if(this.partials[a].base=e,d.subs){b.stackText||(b.stackText={});for(key in d.subs)b.stackText[key]||(b.stackText[key]=void 0!==this.activeSub&&b.stackText[this.activeSub]?b.stackText[this.activeSub]:this.text);e=c(e,d.subs,d.partials,this.stackSubs,this.stackPartials,b.stackText)}return this.partials[a].instance=e,e},rp:function(a,b,c,d){var e=this.ep(a,c);return e?e.ri(b,c,d):""},rs:function(a,b,c){var d=a[a.length-1];if(!l(d))return void c(a,b,this);for(var e=0;e<d.length;e++)a.push(d[e]),c(a,b,this),a.pop()},s:function(a,b,c,d,e,f,g){var h;return l(a)&&0===a.length?!1:("function"==typeof a&&(a=this.ms(a,b,c,d,e,f,g)),h=!!a,!d&&h&&b&&b.push("object"==typeof a?a:b[b.length-1]),h)},d:function(a,c,d,e){var f,g=a.split("."),h=this.f(g[0],c,d,e),i=this.options.modelGet,j=null;if("."===a&&l(c[c.length-2]))h=c[c.length-1];else for(var k=1;k<g.length;k++)f=b(g[k],h,i),void 0!==f?(j=h,h=f):h="";return e&&!h?!1:(e||"function"!=typeof h||(c.push(j),h=this.mv(h,c,d),c.pop()),h)},f:function(a,c,d,e){for(var f=!1,g=null,h=!1,i=this.options.modelGet,j=c.length-1;j>=0;j--)if(g=c[j],f=b(a,g,i),void 0!==f){h=!0;break}return h?(e||"function"!=typeof f||(f=this.mv(f,c,d)),f):e?!1:""},ls:function(a,b,c,e,f){var g=this.options.delimiters;return this.options.delimiters=f,this.b(this.ct(d(a.call(b,e)),b,c)),this.options.delimiters=g,!1},ct:function(a,b,c){if(this.options.disableLambda)throw new Error("Lambda features disabled.");return this.c.compile(a,this.options).render(b,c)},b:function(a){this.buf+=a},fl:function(){var a=this.buf;return this.buf="",a},ms:function(a,b,c,d,e,f,g){var h,i=b[b.length-1],j=a.call(i);return"function"==typeof j?d?!0:(h=this.activeSub&&this.subsText&&this.subsText[this.activeSub]?this.subsText[this.activeSub]:this.text,this.ls(j,i,c,h.substring(e,f),g)):j},mv:function(a,b,c){var e=b[b.length-1],f=a.call(e);return"function"==typeof f?this.ct(d(f.call(e)),e,c):f},sub:function(a,b,c,d){var e=this.subs[a];e&&(this.activeSub=a,e(b,c,this,d),this.activeSub=!1)}};var f=/&/g,g=/</g,h=/>/g,i=/\'/g,j=/\"/g,k=/[&<>\"\']/,l=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)}}("undefined"!=typeof a?a:d),function(a){function b(a){"}"===a.n.substr(a.n.length-1)&&(a.n=a.n.substring(0,a.n.length-1))}function c(a){return a.trim?a.trim():a.replace(/^\s*|\s*$/g,"")}function d(a,b,c){if(b.charAt(c)!=a.charAt(0))return!1;for(var d=1,e=a.length;e>d;d++)if(b.charAt(c+d)!=a.charAt(d))return!1;return!0}function e(b,c,d,h){var i=[],j=null,k=null,l=null;for(k=d[d.length-1];b.length>0;){if(l=b.shift(),k&&"<"==k.tag&&!(l.tag in v))throw new Error("Illegal content in < super tag.");if(a.tags[l.tag]<=a.tags.$||f(l,h))d.push(l),l.nodes=e(b,l.tag,d,h);else{if("/"==l.tag){if(0===d.length)throw new Error("Closing tag without opener: /"+l.n);if(j=d.pop(),l.n!=j.n&&!g(l.n,j.n,h))throw new Error("Nesting error: "+j.n+" vs. "+l.n);return j.end=l.i,i}"\n"==l.tag&&(l.last=0==b.length||"\n"==b[0].tag)}i.push(l)}if(d.length>0)throw new Error("missing closing tag: "+d.pop().n);return i}function f(a,b){for(var c=0,d=b.length;d>c;c++)if(b[c].o==a.n)return a.tag="#",!0}function g(a,b,c){for(var d=0,e=c.length;e>d;d++)if(c[d].c==a&&c[d].o==b)return!0}function h(a){var b=[];for(var c in a)b.push('"'+j(c)+'": function(c,p,t,i) {'+a[c]+"}");return"{ "+b.join(",")+" }"}function i(a){var b=[];for(var c in a.partials)b.push('"'+j(c)+'":{name:"'+j(a.partials[c].name)+'", '+i(a.partials[c])+"}");return"partials: {"+b.join(",")+"}, subs: "+h(a.subs)}function j(a){return a.replace(s,"\\\\").replace(p,'\\"').replace(q,"\\n").replace(r,"\\r").replace(t,"\\u2028").replace(u,"\\u2029")}function k(a){return~a.indexOf(".")?"d":"f"}function l(a,b){var c="<"+(b.prefix||""),d=c+a.n+w++;return b.partials[d]={name:a.n,partials:{}},b.code+='t.b(t.rp("'+j(d)+'",c,p,"'+(a.indent||"")+'"));',d}function m(a,b){b.code+="t.b(t.t(t."+k(a.n)+'("'+j(a.n)+'",c,p,0)));'}function n(a){return"t.b("+a+");"}var o=/\S/,p=/\"/g,q=/\n/g,r=/\r/g,s=/\\/g,t=/\u2028/,u=/\u2029/;a.tags={"#":1,"^":2,"<":3,$:4,"/":5,"!":6,">":7,"=":8,_v:9,"{":10,"&":11,_t:12},a.scan=function(e,f){function g(){s.length>0&&(t.push({tag:"_t",text:new String(s)}),s="")}function h(){for(var b=!0,c=w;c<t.length;c++)if(b=a.tags[t[c].tag]<a.tags._v||"_t"==t[c].tag&&null===t[c].text.match(o),!b)return!1;return b}function i(a,b){if(g(),a&&h())for(var c,d=w;d<t.length;d++)t[d].text&&((c=t[d+1])&&">"==c.tag&&(c.indent=t[d].text.toString()),t.splice(d,1));else b||t.push({tag:"\n"});u=!1,w=t.length}function j(a,b){var d="="+y,e=a.indexOf(d,b),f=c(a.substring(a.indexOf("=",b)+1,e)).split(" ");return x=f[0],y=f[f.length-1],e+d.length-1}var k=e.length,l=0,m=1,n=2,p=l,q=null,r=null,s="",t=[],u=!1,v=0,w=0,x="{{",y="}}";for(f&&(f=f.split(" "),x=f[0],y=f[1]),v=0;k>v;v++)p==l?d(x,e,v)?(--v,g(),p=m):"\n"==e.charAt(v)?i(u):s+=e.charAt(v):p==m?(v+=x.length-1,r=a.tags[e.charAt(v+1)],q=r?e.charAt(v+1):"_v","="==q?(v=j(e,v),p=l):(r&&v++,p=n),u=v):d(y,e,v)?(t.push({tag:q,n:c(s),otag:x,ctag:y,i:"/"==q?u-x.length:v+y.length}),s="",v+=y.length-1,p=l,"{"==q&&("}}"==y?v++:b(t[t.length-1]))):s+=e.charAt(v);return i(u,!0),t};var v={_t:!0,"\n":!0,$:!0,"/":!0};a.stringify=function(b){return"{code: function (c,p,i) { "+a.wrapMain(b.code)+" },"+i(b)+"}"};var w=0;a.generate=function(b,c,d){w=0;var e={code:"",subs:{},partials:{}};return a.walk(b,e),d.asString?this.stringify(e,c,d):this.makeTemplate(e,c,d)},a.wrapMain=function(a){return'var t=this;t.b(i=i||"");'+a+"return t.fl();"},a.template=a.Template,a.makeTemplate=function(a,b,c){var d=this.makePartials(a);return d.code=new Function("c","p","i",this.wrapMain(a.code)),new this.template(d,b,this,c)},a.makePartials=function(a){var b,c={subs:{},partials:a.partials,name:a.name};for(b in c.partials)c.partials[b]=this.makePartials(c.partials[b]);for(b in a.subs)c.subs[b]=new Function("c","p","t","i",a.subs[b]);return c},a.codegen={"#":function(b,c){c.code+="if(t.s(t."+k(b.n)+'("'+j(b.n)+'",c,p,1),c,p,0,'+b.i+","+b.end+',"'+b.otag+" "+b.ctag+'")){t.rs(c,p,function(c,p,t){',a.walk(b.nodes,c),c.code+="});c.pop();}"},"^":function(b,c){c.code+="if(!t.s(t."+k(b.n)+'("'+j(b.n)+'",c,p,1),c,p,1,0,0,"")){',a.walk(b.nodes,c),c.code+="};"},">":l,"<":function(b,c){var d={partials:{},code:"",subs:{},inPartial:!0};a.walk(b.nodes,d);var e=c.partials[l(b,c)];e.subs=d.subs,e.partials=d.partials},$:function(b,c){var d={subs:{},code:"",partials:c.partials,prefix:b.n};a.walk(b.nodes,d),c.subs[b.n]=d.code,c.inPartial||(c.code+='t.sub("'+j(b.n)+'",c,p,i);')},"\n":function(a,b){b.code+=n('"\\n"'+(a.last?"":" + i"))},_v:function(a,b){b.code+="t.b(t.v(t."+k(a.n)+'("'+j(a.n)+'",c,p,0)));'},_t:function(a,b){b.code+=n('"'+j(a.text)+'"')},"{":m,"&":m},a.walk=function(b,c){for(var d,e=0,f=b.length;f>e;e++)d=a.codegen[b[e].tag],d&&d(b[e],c);return c},a.parse=function(a,b,c){return c=c||{},e(a,"",[],c.sectionTags||[])},a.cache={},a.cacheKey=function(a,b){return[a,!!b.asString,!!b.disableLambda,b.delimiters,!!b.modelGet].join("||")},a.compile=function(b,c){c=c||{};var d=a.cacheKey(b,c),e=this.cache[d];if(e){var f=e.partials;for(var g in f)delete f[g].instance;return e}return e=this.generate(this.parse(this.scan(b,c.delimiters),b,c),b,c),this.cache[d]=e}}("undefined"!=typeof a?a:d),"undefined"!=typeof c&&c.exports&&(c.exports=d)}),a("underscore",function(){var a,b=function(a){return a instanceof b?a:this instanceof b?void(this._wrapped=a):new b(a)},c={},d=Array.prototype,e=Object.prototype,f=d.slice,g=e.toString,h=e.hasOwnProperty,i=d.map,j=d.filter,k=d.every,l=d.some,m=d.indexOf,n=Array.isArray,o=b.each=b.forEach=function(b,d,e){if(null!=b)if(a&&b.forEach===a)b.forEach(d,e);else if(b.length===+b.length){for(var f=0,g=b.length;g>f;f++)if(f in b&&d.call(e,b[f],f,b)===c)return}else for(var i in b)if(h.call(b,i)&&d.call(e,i,b[i],b)===c)return};b.map=function(a,b,c){var d=[];return null==a?d:i&&a.map===i?a.map(b,c):(o(a,function(a,e,f){d[d.length]=b.call(c,a,e,f)}),d)},b.find=function(a,b,c){var d;return p(a,function(a,e,f){return b.call(c,a,e,f)?(d=a,!0):void 0}),d},b.every=b.all=function(a,b,d){var e=!0;return null==a?e:k&&a.every===k?a.every(b,d):(o(a,function(a,f,g){return(e=e&&b.call(d,a,f,g))?void 0:c}),e)};var p=b.some=b.any=function(a,d,e){d=d||b.identity;var f=!1;return null==a?f:l&&a.some===l?a.some(d,e):(o(a,function(a,b,g){return f||(f=d.call(e,a,b,g))?c:void 0}),!!f)};return b.include=b.contains=function(a,b){var c=!1;return null==a?c:m&&a.indexOf===m?-1!=a.indexOf(b):c=p(a,function(a){return a===b})},b.filter=function(a,b,c){var d=[];return null==a?d:j&&a.filter===j?a.filter(b,c):(o(a,function(a,e,f){b.call(c,a,e,f)&&(d[d.length]=a)}),d)},b.reduce=function(a,b,c,d){var e=arguments.length>2;if(null==a&&(a=[]),o(a,function(a,f,g){e?c=b.call(d,c,a,f,g):(c=a,e=!0)}),!e)throw new TypeError("Reduce of empty array with no initial value");return c},b.indexOf=function(a,b){if(null==a)return-1;var c,d;if(m&&a.indexOf===m)return a.indexOf(b);for(c=0,d=a.length;d>c;c++)if(c in a&&a[c]===b)return c;return-1},b.uniq=b.unique=function(a,c,d){var e=d?b.map(a,d):a,f=[];return a.length<3&&(c=!0),b.reduce(e,function(d,e,g){return(c?b.last(d)===e&&d.length:b.include(d,e))||(d.push(e),f.push(a[g])),d},[]),f},b.difference=function(a){var c=b.flatten(f.call(arguments,1),!0);return b.filter(a,function(a){return!b.include(c,a)})},b.flatten=function(a,c){return b.reduce(a,function(a,d){return b.isArray(d)?a.concat(c?d:b.flatten(d)):(a[a.length]=d,a)},[])},b.intersection=b.intersect=function(a){var c=f.call(arguments,1);return b.filter(b.uniq(a),function(a){return b.every(c,function(c){return b.indexOf(c,a)>=0})})},b.groupBy=function(a,c){var d={},e=b.isFunction(c)?c:function(a){return a[c]};return o(a,function(a,b){var c=e(a,b);(d[c]||(d[c]=[])).push(a)}),d},b.compact=function(a){return b.filter(a,function(a){return!!a})},b.pluck=function(a,c){return b.map(a,function(a){return a[c]})},b.identity=function(a){return a},b.values=function(a){return b.map(a,b.identity)},b.times=function(a,b,c){for(var d=0;a>d;d++)b.call(c,d)},b.clone=function(a){return b.isObject(a)?b.isArray(a)?a.slice():b.extend({},a):a},b.extend=function(a){return o(f.call(arguments,1),function(b){for(var c in b)void 0!==b[c]&&(a[c]=b[c])}),a},b.defaults=function(a){return o(f.call(arguments,1),function(b){for(var c in b)null==a[c]&&(a[c]=b[c])}),a},b.first=b.head=function(a,b,c){return null==b||c?a[0]:f.call(a,0,b)},b.initial=function(a,b,c){return f.call(a,0,a.length-(null==b||c?1:b))},b.last=function(a,b,c){return null==b||c?a[a.length-1]:f.call(a,Math.max(a.length-b,0))},b.rest=b.tail=function(a,b,c){return f.call(a,null==b||c?1:b)},b.has=function(a,b){return null!=a&&h.call(a,b)},b.keys=function(a){if(!b.isObject(a))return[];var c=[];for(var d in a)b.has(a,d)&&c.push(d);return c},b.size=function(a){return null==a?0:a.length===+a.length?a.length:b.keys(a).length},b.toArray=function(a){return a?a.toArray?a.toArray():b.isArray(a)?f.call(a):b.isArguments(a)?f.call(a):b.values(a):[]},b.escape=function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")},b.template=function(a,c){var d=b.templateSettings,e="var __p=[],print=function(){__p.push.apply(__p,arguments);};with(obj||{}){__p.push('"+a.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(d.escape,function(a,b){return"',_.escape("+b.replace(/\\'/g,"'")+"),'"}).replace(d.interpolate,function(a,b){return"',"+b.replace(/\\'/g,"'")+",'"}).replace(d.evaluate||null,function(a,b){return"');"+b.replace(/\\'/g,"'").replace(/[\r\n\t]/g," ")+";__p.push('"}).replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")+"');}return __p.join('');",f=new Function("obj","_",e);return c?f(c,b):function(a){return f.call(this,a,b)}},b.isEmpty=function(a){if(b.isArray(a)||b.isString(a))return 0===a.length;for(var c in a)if(h.call(a,c))return!1;return!0},b.isArray=n||function(a){return"[object Array]"==g.call(a)},b.isObject=function(a){return a===Object(a)},b.isArguments="[object Arguments]"==g.call(arguments)?function(a){return"[object Arguments]"==g.call(a)}:function(a){return!(!a||!h.call(a,"callee"))},b.isFunction=function(a){return"[object Function]"==g.call(a)},b.isString=function(a){return"[object String]"==g.call(a)},b.isNumber=function(a){return"[object Number]"==g.call(a)},b.isNaN=function(a){return a!==a},b.isBoolean=function(a){return a===!0||a===!1||"[object Boolean]"==g.call(a)},b.range=function(a,b,c){arguments.length<=1&&(b=a||0,a=0),c=arguments[2]||1;for(var d=Math.max(Math.ceil((b-a)/c),0),e=0,f=new Array(d);d>e;)f[e++]=a,a+=c;return f},b.now=Date.now||function(){return(new Date).getTime()},b.throttle=function(a,c,d){var e,f,g,h=null,i=0;d||(d={});var j=function(){i=d.leading===!1?0:b.now(),h=null,g=a.apply(e,f),e=f=null};return function(){var k=b.now();i||d.leading!==!1||(i=k);var l=c-(k-i);return e=this,f=arguments,0>=l?(clearTimeout(h),h=null,i=k,g=a.apply(e,f),e=f=null):h||d.trailing===!1||(h=setTimeout(j,l)),g}},b.partial=function(a){var c=f.call(arguments,1);return function(){for(var d=0,e=c.slice(),f=0,g=e.length;g>f;f++)e[f]===b&&(e[f]=arguments[d++]);for(;d<arguments.length;)e.push(arguments[d++]);return a.apply(this,e)}},b.compose=function(){var a=arguments;return function(){for(var b=arguments,c=a.length-1;c>=0;c--)b=[a[c].apply(this,b)];return b[0]}},b}),function(){a("adm-events",function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o;o=b("util"),l=b("store"),k=b("routes"),c=a.COOKIE_SERVICE_TTL=30*l.MINUTES,d=a.EVENT_TTL=2*l.DAYS,g=a.prefix="e_",e=a.knownEventIds=[],a.addEventId=function(a){o.contains(e,a)||e.push(a)},f=a.parse=function(a){var b;return b=a.split("&"),{id:b.shift(),attrs:o.parseKeyValues(b.join("&"))}},n=a.stringify=function(a){return a.id+"&"+o.paramString(a.attrs)},m=a.storeEvent=function(a,b){b=b||0,l.set(g+n(a),1,d-b)},i=a.processEvent=function(a){var b,c,d,e,f,g;b="event_"+a.id,o.set(b,!0),g=a.attrs;for(d in g)e=g[d],c=b+"_attr_"+d,f=o.get(c)||o.set(c,[]),o.contains(f,e)||f.push(e)},j=a.readFromStore=function(){var a,b;b=l.namespace(g);for(a in b)i(f(a))},h=a.process3rdParty=function(a){var b,c,d,g,h;d=/^e_(.*)/;for(h in a)g=h.match(d),g&&(c=f(g[1].replace(/\^/g,"&").replace(/\|/g,"=")),o.contains(e,c.id)&&(b=(new Date-new Date(parseInt(a[h],10)))/1e3,m(c,b),i(c)))},a.check3rdParty=function(){e.length&&!l.get("event3p")&&b("http").jsonp({url:o.get("url_cookies")||"//beacon.krxd.net/cookie2json",callback:"kxjsonp_3pevents",done:function(a){l.set("event3p","1",c),h(a)}})},j(),k.simple("admEvent",function(a,c){var d;d={id:a,attrs:c},m(d),i(d),b("http").pixel({url:o.get("url_event"),data:o.extend({event_id:a,pub_id:o.get("pubid")},c)})})})}.call(this),function(){var b=[].slice;a("cache",function(a,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r;return p=c("routes").simple,o=c("sha1"),q=c("store"),r=c("util"),d=r.DAY,g=r.defaults,i=r.extend,l=r.identity,e="cache_",j=function(){q.clear(function(a,b){return 0===b.indexOf(e)})},h=function(){var a,c;return c=1<=arguments.length?b.call(arguments,0):[],a=o(""+JSON.stringify(c)),""+e+a},k=function(a,b){var c;return c=q.get(a,b),""!==c?c:void 0},m=function(a,b,c){null==c&&(c=d),null!=a&&null!=b&&q.set(a,b,c)},n=function(a){null!=a&&q.remove(a)},f=function(a,c){var e,f,i,j,n;return null==c&&(c={}),n=g(c,{id:a,parse:l,serialize:l,ttl:d}),e=n.id,f=n.parse,i=n.serialize,j=n.ttl,function(){var c,d,g;return c=1<=arguments.length?b.call(arguments,0):[],d=h(String(e),c),g=k(d),null!=g?f(g):(g=a.apply(null,c),m(d,i(g),j),g)}},p("cache",f),i(f,{PREFIX:e,encode:h,encodeKey:h,flush:j,get:k,put:m,remove:n})})}.call(this),function(){a("client-type",function(){return{PUBLISHER:0,MARKETER:1}})}.call(this),function(){var b=function(a,b){return function(){return a.apply(b,arguments)}},c={}.hasOwnProperty,d=function(a,b){function d(){this.constructor=a}for(var e in b)c.call(b,e)&&(a[e]=b[e]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a},e=[].slice;a("config",function(a,c,f){var g,h,i,j,k;return k=c("util"),j=c("store"),h=c("stateful").Stateful,g=function(a){function c(){this._pointerPair=b(this._pointerPair,this),this._makeWatchers=b(this._makeWatchers,this),this.toString=b(this.toString,this),this.toJSON=b(this.toJSON,this),this.destroy=b(this.destroy,this),this.persist=b(this.persist,this),this.has=b(this.has,this),this.remove=b(this.remove,this),this.set=b(this.set,this),this.get=b(this.get,this),c.__super__.constructor.apply(this,arguments),this._handles=[],this._persisted=[],this._defaults={confid:"no-confid"}}return d(c,a),c.prototype.get=function(a,b){var c,d;if(c=this._pointerPair(a),d=k.isString(c[1])?k.deref(c[0],c[1]):c[0],k.isString(d)){if(/^\d{1,12}$/.test(d))return Number(d);if(/^(true|false)$/.test(d))return"true"===d}return null!=d?d:b},c.prototype.set=function(a,b){var c,d;return d=this._pointerPair(a),k.isString(d[1])?(c=k.deref(d[0],d[1]),d[0][d[1]]=b,this._fire("set",a,c,b)):h.prototype.set.apply(this,arguments),this},c.prototype.remove=function(a){var b,c;return c=this._pointerPair(a),k.isString(c[1])?(b=k.deref(c[0],c[1]),delete c[0][c[1]],this._fire("remove",a,b,void 0)):h.prototype.remove.apply(this,arguments),this},c.prototype.has=function(a){return c.__super__.has.call(this,a)||null!=this.get(a)},c.prototype.persist=function(){var a,b,c,d,f,g;return b=1<=arguments.length?e.call(arguments,0):[],b=k.difference(b,this._persisted),c=function(a){return function(b){a.has(b,!0)&&j.set(b,a.get(b))}}(this),b=function(){var e,f,g;for(g=[],e=0,f=b.length;f>e;e++)a=b[e],d=k.partial(c,a),d(),g.push(this._makeWatchers(a,d));return g}.call(this),(f=this._handles).push.apply(f,b),(g=this._persisted).push.apply(g,b),this},c.prototype.destroy=function(){var a,b,c,d;for(d=this._handles,b=0,c=d.length;c>b;b++)(a=d[b])();return this},c.prototype.toJSON=function(){return k.extend({},this._defaults,this._raw)},c.prototype.toString=function(){return"Config"+f.JSON.stringify(this._raw)},c.prototype._has=function(){return h.prototype.has.apply(this,arguments)},c.prototype._makeWatchers=function(a,b){return k.compose(this.watch("set:"+a,b),this.watch("remove:"+a,function(){j.remove(a)}))},c.prototype._pointerPair=function(a){var b,c,d,e,f,g;return b=!1,f=a,e=void 0,a.indexOf(".")>0&&!this._has(a)&&(e=a.split("."),f=e[0],b=!0),g=h.prototype.get.call(this,f),b&&(d=e.slice(1,e.length-1).join("."),d&&(g=k.deref(g,d)),c=e.pop()),[g,c]},c}(h),i=void 0,k.extend(function(a){return(a||!i)&&(i=new g(a)),i},{Config:g})})}.call(this),function(){a("context-terms",function(a,b,c){var d,e,f,g,h,i,j;j=b("util"),e=c.document,f=["a","form","script","noscript","style","select","textarea","button"],d=new RegExp("<("+f.join("|")+")\\b","i"),g=new RegExp("^("+f.join("|")+")$","i"),a.process=function(a){var b,c,f,h,i,k,l,m;for(f=[e.body],k="";c=f.shift();)3===c.nodeType?k+=c.nodeValue:1===c.nodeType&&(g.test(c.nodeName)||(d.test(c.innerHTML)?f.unshift.apply(f,j.toArray(c.childNodes)):k+=c.innerText||c.textContent));for(k=k.replace(/\s\s+/g," "),l=0,m=a.length;m>l;l++)i=a[l],i.matches=0,h=new RegExp("\\b"+j.escapeRegexp(i.value)+"\\b","ig"),k.replace(h,function(){i.matches++});return b=function(){var b,c,d;for(d=[],b=0,c=a.length;c>b;b++)i=a[b],j.set("context_term_"+i.id,i.matches)&&d.push(i);return d}(),j.set("context_terms_processed",!0),j.set("page_attr_kx_context_terms",b),j.set("context_terms",function(){var a,c,d;for(d=[],a=0,c=b.length;c>a;a++)i=b[a],d.push(i.id);return d}()),{text:k,terms:b}},h=b("pixel"),i=a.pixelFormatter=function(a){var b;return function(){var c,d,e;for(e=[],c=0,d=a.length;d>c;c++)b=a[c],e.push(""+b.id+h.tuppleSeparator+b.matches);return e}().join(",")},h.addFormatter("_kpa_kx_context_terms",i)})}.call(this),function(){a("crypto-util",function(a){var b,c,d,e,f,g,h,i,j,k,l,m;return k=32,c=8,e=k/c,d=e*c,b=2,g=16,j="0",h=255,i=4294967295,f=15,m=function(a,b,d){return(a|b<<k-c-d%e*c)>>>0},l=function(a){var b,c,d;for(c=[],b=2*e,d=0;d<a.length;)c.push(a.substr(d,b)),d+=b;return c},a={BITS_PER_BYTE:c,BITS_PER_WORD:d,BYTES_PER_WORD:e,MAX_BYTE:h,MAX_WORD:i,WORD_SIZE:k,pad:function(a,b,c){var d,e,f,g;for(c=c||k,b=b||j,d=[],f=a.length,g=c-f,e=0;g>e;)d.push(b),++e;return d.join("")+a},fromWordToBytesArray:function(a){var b,d,f;for(f=[],b=d=0;e>=0?e>d:d>e;b=e>=0?++d:--d)f.push(a>>>k-c-b%e*c&h);return f},fromBytesArrayToWord:function(a){var b,c,d,e,f;for(d=0,c=e=0,f=a.length;f>e;c=++e)b=a[c],d=m(d,b,c);return d},toWord:function(c){return a.pad(Number(c).toString(b))},fromWord:function(a){return parseInt(a,b)},toHex:function(a){return Number(a).toString(g)},fromHex:function(a){return parseInt(a,g)},rotl:function(a,b,c){return a<<b|a>>>(c||k)-b},rotr:function(a,b,c){return a>>>b|a<<(c||k)-b},fromWordsToLatin1:function(b){var c,d,e,f,g,h,i,j;for(d="",f=0,h=b.length;h>f;f++)for(e=b[f],j=a.fromWordToBytesArray(e),g=0,i=j.length;i>g;g++)c=j[g],d+=String.fromCharCode(c);return d},fromLatin1ToWords:function(a){var b,d,f;for(f=[],b=0,d=a.length;d>b;)f[b>>>2]|=(a.charCodeAt(b)&h)<<k-c-b%e*c,b++;return f},fromWordsToUtf8:function(b){try{return decodeURIComponent(escape(a.fromWordsToLatin1(b)))}catch(c){throw new Error("Malformed UTF-8 data")}},fromUtf8ToWords:function(b){return a.fromLatin1ToWords(unescape(encodeURIComponent(b)))},fromWordsToHex:function(a){var b,d,i,j;for(j=e*a.length,d=[],i=0;j>i;)b=a[i>>>2]>>>k-c-i%e*c&h,d.push((b>>>e).toString(g)),d.push((b&f).toString(g)),i++;return d.join("")},fromHexToWords:function(b){var c,d,e,f;for(e=l(b),f=[],c=0,d=e.length;d>c;c++)b=e[c],f.push(a.fromHex(b));return f},calculateSigBytesForWords:function(b){var c,d,e,f,g,h,i,j;for(d=0,f=0,h=b.length;h>f;f++)for(e=b[f],j=a.fromWordToBytesArray(e),g=0,i=j.length;i>g;g++)c=j[g],c&&(d+=1);return d}}})}.call(this),function(){a("data-rewrite",function(a,b){var c,d,e,f,g,h;h=b("util"),d=b("expression"),c=h.rewriter({country:"user_attr_kx_geo_country",sub_section:"subsection",segment:"user_segments"}),f=h.rewriter({"=":"is","!=":"isnt",before:"<",after:">"}),g=function(a){return a=String(a),a.match(/,/)?"["+a.split(", ").join(",")+"]":a},e=a.expression=function(a){var b,e,i,j,k,l,m;if(e=f(a.operator),k=c(a.name),b=a.delimiter,m=h.isArray(a.value)?"["+a.value.join(",")+"]":g(a.value),j=function(a,b,c){var d,e,f,g;for(g=[],e=0,f=a.length;f>e;e++)d=a[e],g.push([b,"$"+c,d]);return g},i=h.isArray(d.get(k,b)),l=d.parse(m),h.isArray(l)){if("is"===e&&(e=i?"intersects":"memberOf"),"isnt"===e&&(e=i?"notIntersects":"notMemberOf"),"url"===k&&!i){if("contains"===e)return["or"].concat(j(l,e,k));if("notContains"===e)return["and"].concat(j(l,e,k))}}else i&&("is"===e&&(e="contains"),"isnt"===e&&(e="notContains"));return b=b?":"+b:"",[e,"$"+k+b,m]},a.tag=function(a){var b,c;return c=h.extend({},a,{criteria:["and"].concat(function(){var c,d,f,g;if(a.criteria){for(f=a.criteria,g=[],c=0,d=f.length;d>c;c++)b=f[c],g.push(e(b));return g}return[]}())}),c.freq_cap&&c.criteria.push(["<","$tag_deliveries_today",c.freq_cap]),c.user_percent&&c.criteria.push(["<",["random"],c.user_percent/100]),delete c.rules,/^\s*\/\/@eval\b/.test(c.content)&&(c.method="eval"),c.name=c.name||"Anonymous",c.timing=c.timing||"onload",c},d.setDelimiter("user_segments",","),a.contextTermExpression=function(a){var b,c,e;return b=f(a.operator),d=void 0,"is"===b?(e=a.occurrences.min||1,d=["or"].concat(function(){var b,d,f,g;for(f=a.values.split(","),g=[],b=0,d=f.length;d>b;b++)c=f[b],g.push([">=","$context_term_"+c,e]);return g}())):d=["and"].concat(function(){var b,d,e,f;for(e=a.values.split(","),f=[],b=0,d=e.length;d>b;b++)c=e[b],f.push(["is","$context_term_"+c,0]);return f}()),["and","$context_terms_processed",d]}})}.call(this),function(){a("data",function(a,b,c){var d,e,f,g,h,i,j,k,l;l=b("util"),k=a.root={},f=a.defs={},g=function(a){return a.match(/_/)?a:"_"+a},l.get=a.get=function(a){return k[g(a)]},l.set=a.set=function(a,b){var c,d;return l.isString(a)?(a=g(a),k[a]=b,l.fire("data:change",{key:a,value:b}),b):function(){var b;b=[];for(c in a)d=a[c],b.push(l.set(c,d));return b}()},l.removeData=a.remove=function(a){delete k[a]},l.append=a.append=function(a,b){var c,d,e;return l.isString(a)?(a=g(a),d=null!=l.get(a)?l.get(a):[],l.isArray(d)||(d=[d]),d.push(b),l.set(a,l.uniq(d))):function(){var b;b=[];for(c in a)e=a[c],b.push(l.append(c,e));return b}()},a.raw=function(){return k},e=a.define=function(a,b){var c,d;if(!l.isString(a))for(c in a)return d=a[c],e(c,d);f[a]=b},d=a.defaults=function(a,b){var c,e,f;if(!l.isString(a))for(c in a)return e=a[c],d(c,e);return f=l.get(a),null!=f?f:l.set(a,b)},i=a.namespace=function(a,b){var c,d,e,f,g;return f=a+"_",d=void 0,g=new RegExp(f+"(.+)"),c=l.attributes({get:function(a){return l.get(f+a)},set:function(a,b){return l.set(f+a,b)},all:function(){var a,b,c;b={};for(a in k)c=k[a],d=a.match(g),null!=d&&(b[d[1]]=c);return b},values:b}),e=void 0,c.change=function(a){e||(e=[],l.on("data:change",function(b){var c,f;if(d=b.key.match(g),null!=d)for(c=0,f=e.length;f>c;c++)(a=e[c])(b)})),e.push(a)},c},a.user_attr=i("user_attr"),a.page_attr=i("page_attr"),b("routes").simple("set",l.set),b("routes").simple("get",l.get),b("routes").simple("append",l.append),b("routes").regexp(/data:(.+)/,function(a,b){return i(a[1],b)}),j=c.navigator,h=j.language||j.browserLanguage||j.userLanguage||j.systemLanguage,h&&(h=h.replace("_","-"),h=h.toLowerCase()),a.user_attr("kx_lang",h),a.user_attr("kx_tech_browser_language",h)})}.call(this),function(){a("dataprovider",function(a,b){var c,d,e,f,g;d=b("http"),g=b("util"),f=a.userMatch=function(a,b,c){return d.pixel({url:g.get("url_um"),data:{partner:a,r:b,_kdpid:c}})},c=a.exelate=function(){return f("exelate","//loadm.exelator.com/load/","e4942ff0-4070-4896-a7ef-e6a5a30ce9f9")},e=b("routes"),e.simple("dataprovider.exelate",c)})}.call(this),function(){a("dom-iframe",function(a,b,c){var d;d=b("util"),a.IFrame=function(){var a,e;return a=function(a){this.options=d.extend({},e,a||{}),this.node=b("dom").createElement("iframe",this.options.attr),this.insert(),(!this.options.attr.src||this.options.html)&&this.html(this.options.html||"")},e={target:null,targetAction:"append",html:"",attr:{}},a.prototype={insert:function(){var d,e,f;e=this.options,d=e.targetAction,f=e.target||c.document.body,b("dom").insert(d,f,this.node),this.win=a.window(this.node),this.doc=a.document(this.node)},html:function(a){var b;b=this.doc,a.match(/^<html>/)||(a="<html><head></head><body>"+a+"</body></html>"),b.open(),b.write(a),b.close()}},a.window=function(a){return a.contentWindow},a.document=function(b){return a.window(b).document},a}()})}.call(this),function(){var b=function(a,b){return function(){return a.apply(b,arguments)}},c=[].slice;a("dom",function(a,d,e){var f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P;for(M=d("util"),D=d("sniff"),F=[d("dom-iframe"),D],l=e.document,C=e.setTimeout,f=l.documentElement.attachEvent?"attachEvent":"addEventListener",N=0,O=F.length;O>N;N++){E=F[N];for(v in E)K=E[v],a[v]=K}a.browserBucket=D.bucket,B=new M.Set(["area","base","basefont","br","col","frame","hr","img","input","isindex","link","meta","param","embed"]),u=function(a){return!!B[a]},i=a.attr=function(a,b,c){var d,e;if(e="",void 0!==c)return a.setAttribute(b,c),a;try{return a.getAttribute(b)||null!=(d=a.attributes[b])&&d.value||e}catch(f){return e}},a.removeAttr=function(a,b){return a.removeAttr(b)},H=a.text=function(a){return a.innerText||a.textContent},a.value=function(a){switch(a.nodeName){case"INPUT":return i(a,"value");case"TEXTAREA":return H(a)}},a.StringStream=g=function(){function a(){var a;return a=1<=arguments.length?c.call(arguments,0):[],this.stream=b(this.stream,this),this.data=b(this.data,this),this._buffer=a,this.stream.data=this.data,this.stream}return a.prototype.data=function(){return this._buffer.join("")},a.prototype.stream=function(){var a,b;return a=1<=arguments.length?c.call(arguments,0):[],(b=this._buffer).push.apply(b,a)},a}(),L=function(a,b,c){var d,e,f,h,i,j,k,l;null==b&&(b=new g),null==c&&(c=0),h=M.defaults(a,{attributes:{},children:[]}),j=h.tagName,d=h.attributes,f=h.children,i=u(j),b("<",j);for(v in d)K=d[v],b(" ",v,'="',K,'"');if(i)return b("/>");if(b(">"),"string"==typeof f)b(f);else for(k=0,l=f.length;l>k;k++)e=f[k],L(e,b,c+1);return b("</",j,">"),b},k=function(a,b,c){var d;return null==b&&(b={}),null==c&&(c=[]),d="string"!=typeof a?a:{tagName:a,attributes:b,children:c},L(d).data()},t=function(a){var b;return b=l.createElement("div"),b.innerHTML=a,b.childNodes},s=function(a){return t(a)[0]},a.byId=function(a){return(null!=a?a.nodeType:void 0)?a:l.getElementById(a)},r=a.head=function(a){return null==a&&(a=l),a.head||a.getElementsByTagName("head")[0]},a.document=function(a){return a.document||a.ownerDocument||a},a.window=function(b){var c;return c=a.document(b),c.parentWindow||c.defaultView},a.create=a.createElement=function(){var a;return a=1<=arguments.length?c.call(arguments,0):[],s(k.apply(null,a))},A=a.remove=function(a){a.parentNode.removeChild(a)},a.isNode=function(a){return!!a.nodeType},j=a.before=function(a,b){a.parentNode.insertBefore(b,a)},h=a.append=function(a,b){a.appendChild(b)},a.after=function(a,b){var c;return c=a.nextSibling,c?j(c,b):h(a.parentNode,b)},a.prepend=function(a,b){var c;return c=a.firstChild,c?j(c,b):h(a,b)},a.insert=function(b,c,d){return 3===arguments.length?a[b](c,d):(d=b,j(l.getElementsByTagName("script")[0],d))},a.replace=function(a,b){return j(a,b),A(a)},a.scriptEval=function(a){var b;b=l.createElement("script"),b.text=a,r(l).appendChild(b)},a.winEval=function(a,b){var c;return a.kxeval||(c="(function(){,\n  var win = this;,\n  win.kxeval = win.execScript ? ,\n    function(expr){return win.execScript(expr);} :,\n    function(expr){return win.eval(expr);};,\n})();",a.execScript?a.execScript(c):a.eval(c)),a.kxeval(b)},a.childElements=function(a){var b,c,d,e,f;for(c=[],f=a.childNodes,d=0,e=f.length;e>d;d++)b=f[d],1===b.nodeType&&c.push(b);return c},a.onload=function(a,b){var c,d,e,g,h,i,j;"function"==typeof b&&(b={done:b}),c=b.done,g=b.fail,c=M.once(c||M.noop),g=M.once(g||M.noop),j=function(){return a.readyState&&a.readyState.match(/complete|loaded/)?c():void 0},e={load:c,error:g,readystatechange:j},i=a.attachEvent?"on":"";for(d in e)h=e[d],a[f](i+d,h,!0)},q="_krux_hash",p=1,o=a.hash=function(a){return a[q]||(a[q]=p++)},w={},a.meta=function(a){var b;return b=o(a),w[b]||(w[b]={node:a,hash:b})},d("events"),y=!!e.window.attachEvent,P=a._on_=y?"attachEvent":"addEventListener",J=a.type={ready:{target:e.document},load:{target:e},unload:{target:e},beforeunload:{target:e}},z=a.on=function(a,b,c,d){b=y?"on"+b:b,a[P](b,c,d||!1)},a.d2on=e.addEventListener?function(a,b,c){return a.addEventListener(b,c,!1),{remove:function(){a.removeEventListener(b,c)
}}}:function(a,b,c){return a.attachEvent(b,c),{remove:function(){a.detachEvent(b,c)}}};for(x in J)G=J[x],G.nativeName="ready"!==x?x:y?"readystatechanged":"DOMContentLoaded",a[x]=function(a){return function(b){M.onOnce("dom:"+a,b)}}(x);if(n=function(a,b){return null==b&&(b=void 0),"load"!==a?function(){M.fireOnce("dom:"+a,b)}:function(){M.fireOnce("dom:ready",b),M.fireOnce("dom:load",b)}},m=function(){try{l.documentElement.doScroll("left")}catch(a){return void C(m,1)}M.fireOnce("dom:ready")},a.createHead=function(b,c){var e,f,g;return g=d("sizzle"),(f=M.first(g.find('.kxhead[data-id="'+b+'"]')))?f:(a.kxhead=f=a.create("div",{"class":"kxhead","data-id":b,style:"display:none !important;"}),c?a.before(c,f):a.append(l.body,f),e=a.insert,a.insert=function(b){1===arguments.length?a.append(f,b):e.apply(a,arguments)},f)},a.kruxDomain=function(a){var b;return b=String(a).replace(/:\d+$/,""),/(?:\d{1,3}\.){3}\d{1,3}/.test(b)?"":b.replace(/.*?((?:(^|\.)[^\.]+){1,2}(?:\.com)?)$/,"$1").replace(/^\./,"")},a.safeMode=function(){return e.location.href.indexOf("krux_safe")>-1||D.ie&&D.version<8||D.ff&&D.version<4||!e.document.readyState||function(){var a;try{return null==(null!=(a=e.JSON)&&"function"==typeof a.parse?a.parse("true"):void 0)}catch(b){return!0}}()},/^(complete|loaded)$/.test(e.document.readyState))n("load")();else{if(D.ie){z(e,J.load.nativeName,n("ready")),I=!1;try{I=null==e.window.frameElement}catch(Q){}l.documentElement.doScroll&&I&&m()}for(x in J)G=J[x],z(G.target,G.nativeName,n(x),!1)}C(function(){return n("load",{timedout:!0})},6e3)})}.call(this),function(){var b=function(a,b){return function(){return a.apply(b,arguments)}};a("events",function(a,c){var d,e,f,g,h,i,j;for(g=c("util"),a.Events=d=function(){function a(){this.clear=b(this.clear,this),this.happened=b(this.happened,this),this.onOnceAll=b(this.onOnceAll,this),this.fireOnce=b(this.fireOnce,this),this.onOnce=b(this.onOnce,this),this.fire=b(this.fire,this),this.off=b(this.off,this),this.on=b(this.on,this),this._handlers={ALL:[]},this._happened={}}return a.prototype.on=function(a,b){g.isString(a)?(null==this._handlers[a]&&(this._handlers[a]=[]),this._handlers[a].push(b)):g.isFunction(a)?this._handlers.ALL.push(a):this.on(function(c){a.test(c.type)&&b(c)})},a.prototype.off=function(a,b){this._handlers[a]=b?g.remove(this._handlers[a],b):[]},a.prototype.fire=function(a,b){var c,d,e,f,h,i,j;if(b=b||{},b.type||(b.type=a),this._happened[a]=b,"data:change"!==b.type&&g.log(b),null!=this._handlers[a])for(i=this._handlers[a],d=0,f=i.length;f>d;d++)(c=i[d])(b);if(null!=this._handlers.ALL)for(j=this._handlers.ALL,e=0,h=j.length;h>e;e++)(c=j[e])(b);return b},a.prototype.onOnce=function(a,b){var c;return(c=this._happened[a])?g.defer(b,c):this.on(a,g.once(b))},a.prototype.fireOnce=function(a,b){return!this._happened[a]&&this.fire(a,b)},a.prototype.onOnceAll=function(a,b){var c,d,e,f;for(a=a.split(" "),b=g.once(b),c=function(c){return function(){var d,e,f;for(e=0,f=a.length;f>e;e++)if(d=a[e],!c._happened[d])return;b()}}(this),e=0,f=a.length;f>e;e++)d=a[e],this.onOnce(d,c)},a.prototype.happened=function(a){return this._happened[a]},a.prototype.clear=function(a){var b,c,d;c=this._happened,this._happened={};for(b in c)d=c[b],a&&0!==b.indexOf(a)&&(this._happened[b]=d)},a}(),e=a.instance=new d,j=["on","off","fire","onOnce","fireOnce","onOnceAll","happened"],h=0,i=j.length;i>h;h++)f=j[h],g[f]=e[f]})}.call(this),function(){a("expression",function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u;for(q=b("util"),j=q.isArray,k=q.isString,e={},f={},r=void 0,i=a.getDelimiter=function(a){return q.get(a+"DELIM")},o=a.setDelimiter=function(a,b){i(a)!==b&&q.set(a+"DELIM",b)},h=a.get=function(a,b){var c;return c=q.get(a),b&&o(a,b),b=i(a),q.isArray(c)?c:b?c?c.split(b):[]:c},n=a.parse=function(a){var b,c,d,e,f,g,i,j,k,l;switch(!1){case!!q.isString(a):return a;case!(b=a.match(/^\$([^:]+)(?::(.*))?$/)):return h(b[1],b[2]);case!(b=a.match(/^\[\s*((?:"|').*(?:"|'))\s*]$/)):for(i=b[1].replace(/("|')\s*,\s*\\?("|')/g,'"$DELIM$"').split("$DELIM$"),k=[],d=0,f=i.length;f>d;d++)c=i[d],k.push(n(c));return k;case!(b=a.match(/^\[\s*(.*)\s*]$/)):for(j=b[1].split(/\s*,\s*/),l=[],e=0,g=j.length;g>e;e++)c=j[e],l.push(n(c));return l;case!(b=a.match(/^"(.*)"$/)):return b[1];default:return a}},g=function(a){var b;return b=r(a),b&&(e[b]||f[b])},d=function(a,b){var c,d,e,f,g;if(b)return a.slice(1);for(f=a.slice(1),g=[],d=0,e=f.length;e>d;d++)c=f[d],g.push(r(c));return g},c=function(a){var b;return b=g(a[0]),b.apply(this,d(a,b.isMacro))},r=a.eval=function(a){return j(a)?c(a):k(a)?n(a):a},q.extend(e,{is:function(a,b){return q.isString(a)?a.toLowerCase()===String(b).toLowerCase():a===b},matches:function(a,b){return new RegExp(b).test(a)},startsWith:function(a,b){return e.matches(a,"^"+q.escapeRegexp(b))},endsWith:function(a,b){return e.matches(a,q.escapeRegexp(b)+"$")},contains:function(a,b){var c;return a=a||[],c=(""+b).toLowerCase(),q.isArray(a)?q.any(a,function(a){return(""+a).toLowerCase()===c}):(""+a).toLowerCase().indexOf(c)>=0},memberOf:function(a,b){return e.contains(b,a)},intersection:function(a,b){return q.intersection(a,b)},intersects:function(a,b){return a=q.isArray(a)?a:[a],b=q.isArray(b)?b:[b],q.any(a,function(a){return e.contains(b,a)})},random:function(){return Math.random()},now:function(){return new Date}}),u=["<",">","<=",">="],s=0,t=u.length;t>s;s++)p=u[s],e[p]=new Function("a","b","return a "+p+" b");q.extend(e,{isnt:q.negate(e.is),notMemberOf:q.negate(e.memberOf),notContains:q.negate(e.contains),notIntersects:q.negate(e.intersects)}),q.extend(f,{and:function(){return q.every(arguments,r)},or:function(){return q.any(arguments,r)}});for(m in f)l=f[m],l.isMacro=!0})}.call(this),function(){a("feature",function(a,b){var c;return c=b("sniff"),{hasThirdPartyCookies:function(){return c.is!==c.Browsers.SAFARI}}})}.call(this),function(){var b=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};a("fingerprint-scraper",function(a,c){var d,e,f,g,h;h=c("util"),d=a.all=function(a,b){var c,d,e,f;null==b&&(b=h.yes),d=h.deref(a),f=[];for(c in d)e=d[c],b(e,c,d)&&null!=e&&f.push(e);return f},a.path=h.deref,e=function(a){return function(c,d){return a(c,function(a,c){return b.call(d,c)>=0})}},a.keys=e(d),f=a.pluckAll=function(a,b){var c,d,e,f,g,i,j;for(null==b&&(b=h.yes),c=h.deref(a),c.length||(c=h.values(c)),f=[],i=0,j=c.length;j>i;i++){e=c[i];for(d in e)g=e[d],e.hasOwnProperty(d)&&b(g,d,e)&&f.push(g)}return f},g=a.pluckKeys=e(f),a.pluckKeysWhere=function(a,b,c){var d,e,f,h,i,j;for(e=g(a,b),j=[],d=h=0,i=e.length;i>h;d=++h)f=e[d],c(f,d,e)&&j.push(f);return j},a.primitives=h.partial(d,h._,h.isPrimitive),a.serializable=h.partial(d,h._,h.isSerializable)})}.call(this),function(){a("fingerprint",function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o;return o=b("util"),d=b("cache"),j=b("fingerprint-scraper"),m=b("sha1"),b("data"),h=o.partial(j.keys,"navigator"),k=o.partial(j.keys,"screen"),n=function(a){return a[0]*a[1]},l=o.compose(k,n),e=o.partial(o.deref,c),a.canvas=function(){var a,b,c;return a=document.createElement("canvas"),b=a.getContext("2d"),c="F1ng3r Print",b.textBaseline="top",b.font="14px 'Arial'",b.textBaseline="alphabetic",b.fillStyle="#f60",b.fillRect(125,1,62,20),b.fillStyle="#069",b.fillText(c,2,15),b.fillStyle="rgba(102, 204, 0, 0.7)",b.fillText(c,4,17),[a.toDataURL()]},a.winSize=function(){var a,b,c,d,f,g;for(f=[["innerHeight","innerWidth"],["outerHeight","outerWidth"]],g=[],c=0,d=f.length;d>c;c++)b=f[c],g.push(n(function(){var c,d,f;for(f=[],c=0,d=b.length;d>c;c++)a=b[c],f.push(e(a));return f}()));return g},a.mimeTypes=o.partial(j.pluckKeysWhere,"navigator.mimeTypes",["type","description","suffixes"],function(a){return""!==a&&o.isString(a)||o.isNumber(a)&&!o.isNaN(a)}),a.navigatorPrimitives=o.partial(h,["onLine","product","appCodeName","platform","appVersion","appName","vendorSub","vendor","productSub","cookieEnabled","language"]),a.plugins=o.partial(j.pluckKeys,"navigator.plugins",["name","filename","description"]),a.screenDepth=o.partial(k,["pixelDepth","colorDepth"]),a.screenResolution=o.partial(l,["availWidth","availHeight"]),a.screenSize=o.partial(l,["width","height"]),a.timezone=function(){return[(new Date).getTimezoneOffset()]},a.ua=function(){var a;return a=j.path("navigator.userAgent"),[String(a).replace(/([a-z0-9]){8}\-(\1{4})\-\2\-\2\-\1{12}/i,"")]},i=function(){var b,c,d,e;c=[];for(e in a){b=a[e];try{d=b(),c.push.apply(c,d)}catch(f){}}return c},f=function(){return m(i().sort().join(""))},g=function(a){var b,c;return c=a.get("fp_id"),b=d(f,{ttl:30*o.MINUTES})(),o.set("fp",b),a.set("fp",b),o.set("fp_id",c),o.onOnce("user_data_response",function(b){b.kfuid&&(o.set("fp_id",b.kfuid),a.set("fp_id",b.kfuid))}),b},o.extend(g,a,{raw:i})})}.call(this),function(){a("flash",function(a,b,c){var d,e,f;d=function(a){try{return a.GetVariable("$version")}catch(b){}return""},e=function(a){var b;return b=a.split(","),{installed:!0,raw:a,major:parseInt(b[0].split(" ")[1],10),minor:parseInt(b[1],10),revision:parseInt(b[2],10),revisionStr:b[2]}},f=function(a){var b,c,d;return b=a.split(RegExp(" +")),c=b[2].split(/\./),d=b[3],{installed:!0,raw:a,major:parseInt(c[0],10),minor:parseInt(c[1],10),revision:parseInt(d.replace(/[a-zA-Z]/g,""),10)||d,revisionStr:d}},a.version=function(){var a,g,h;if(h=b("util"),g="",a=null,null!=c.navigator.plugins&&c.navigator.plugins.length>0){if(g=h.deref(c.navigator,"mimeTypes.application/x-shockwave-flash.enabledPlugin.description"))return f(g)}else if(-1===c.navigator.appVersion.indexOf("Mac")&&null!=window.execScript){try{a=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6"),g="6,0,21",a.AllowScriptAccess="always",g=d(a)}catch(i){}try{a=new ActiveXObject("ShockwaveFlash.ShockwaveFlash"),g=d(a)}catch(i){}if(g)return e(g)}return{installed:!1,raw:"",major:"",minor:"",revision:"",revisionStr:""}}})}.call(this),function(){a("geo",function(a,b,c){var d,e,f,g,h,i,j,k,l,m;return m=b("util"),e=b("config"),j=b("privacy"),k=b("store"),b("data"),b("events"),h=function(a){return String(a).toLowerCase()},i=function(a){var b,c,d;for(b in a)d=a[b],c=h(b),c!==b&&(delete a[b],a[c]=d);return a},f=function(a){var b,c,d,e;for(e=["country","region","city","dma"],c=0,d=e.length;d>c;c++)b=e[c],m.set("user_attr_kx_geo_"+b,a[b]||a[b.toUpperCase()])},l=function(a){k.impl&&k.set("geo",m.paramString(a),24*k.HOURS)},g=function(){return k.impl?m.parseParams(k.get("geo")):{}},d="geo",a=m.extend(function(){var b,f,h,i,k;if(f=e(),f.get("params.no_pii")||j.isOptOut()){for(h in a)i=a[h],m.isFunction(i)&&(a[h]=m.noop);return f.set(d,{}),a}return k=f.get(d),m.isString(k)&&f.set(d,k=c.JSON.parse(k)),m.isEmpty(k)?(m.on("user_data_response",function(b){var c;c=(b||{}).geo||{},l(c),a.receive(c)}),b=g(),m.isEmpty(b)||a.receive(b)):(a.receive(k),l(k)),a},{get:function(a){var b;return b=m.get(d)||{},a?b[h(a)]:b},set:function(b,c){return null!=c?m.get(d)[h(b)]=c:m.set(d,i(b)),a},receive:function(b){return a.set(b),f(b),m.fireOnce("geo:ready",a),a}})})}.call(this),function(){var b=[].slice;a("hash-set",function(a,c){var d,e;return e=c("util"),d=function(){function a(){var a,c;a=arguments[0],c=2<=arguments.length?b.call(arguments,1):[],this._hash=function(b){var c;return c=e.isFunction(a)?a(b):b,String(void 0!==c?c:b)},this._q=[],this.put.apply(this,c),this._items={}}return a.prototype.put=function(){var a,c;return a=1<=arguments.length?b.call(arguments,0):[],(c=this._q).push.apply(c,a),this},a.prototype.get=function(a){return this._thunk(),this._items[this._hash(a)]},a.prototype.has=function(a){return this._thunk(),this._hash(a)in this._items},a.prototype.remove=function(){var a,c,d,e;for(c=1<=arguments.length?b.call(arguments,0):[],this._thunk(),d=0,e=c.length;e>d;d++)a=c[d],delete this._items[this._hash(a)];return this},a.prototype.toArray=function(){var a,b,c,d;this._thunk(),c=this._items,d=[];for(b in c)a=c[b],d.push(a);return d},a.prototype.fromArray=function(a){return this.put.apply(this,a),this},a.prototype.toString=function(){var a;return this._thunk(),function(){var b;b=[];for(a in this._items)b.push(a);return b}.call(this).join(",")},a.prototype.empty=function(){return this._q=[],this._items={},this},a.prototype.size=function(){var a;return this._thunk(),function(){var b;b=[];for(a in this._items)b.push(a);return b}.call(this).length},a.prototype._thunk=function(){var a,b,c,d;for(d=this._q.splice(0,this._q.length),b=0,c=d.length;c>b;b++)a=d[b],this._items[this._hash(a)]=a;return this},a}(),e.extend(function(){var a,c,e;return c=arguments[0],e=2<=arguments.length?b.call(arguments,1):[],a=new d(c),a.put.apply(a,e),a},{HashSet:d})})}.call(this),function(){a("http-jsonp",function(a,b,c){var d,e,f,g,h;h=b("util"),g=b("ns"),e=c.document,f=g.self.inFlightKeys=g.self.inFlightKeys||{},a.Request=d=function(){function a(c){var d,e;if(c.data=c.data||{},this.options=c,!c.callback)throw new Error("Callback name is required");for(d in c)e=c[d],this[d]=e;this.self&&(this.done=function(a){var b;return(b=this.self).done.apply(b,a)},this.fail=function(a){var b;return(b=this.self).fail.apply(b,a)}),this.plantReceiver(),this.src=b("http").src(this),a.all.push(this)}return a.all=[],a.prototype.fail=function(a){var b;b=a&&a.status||"unknown",h.fire("error",{message:"jsonp failed with status "+b+" src: "+this.src})},a.prototype.done=function(){},a.prototype.receive=function(a){return this.time.end=new Date,a.status?"200"===String(a.status)?this.done(a.body):this.fail(a):this.done(a)},a.prototype.plantReceiver=function(){var a;a=this.options.callback,this.data.callback=g.path+"."+a,f[a]=f[a]||0,f[a]++,g.self[a]=function(b){return function(){f[a]--,0===f[a]&&delete g.self[a],b.receive.apply(b,arguments)}}(this)},a.prototype.sendInline=function(){var a;return a='<script src="'+this.src+'" type="text/javascript"></script>',e.write(a),this},a.prototype.send=function(){var a,b;return this.time={start:new Date},this.inline?this.sendInline():(a=e.createElement("script"),a.type="text/javascript",a.src=this.src,b=e.getElementsByTagName("script")[0],b.parentNode.insertBefore(a,b),this)},a}(),a.call=function(a){return new d(a).send()}})}.call(this),function(){a("http",function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n;n=b("util"),j=b("sniff"),m=b("uuid"),i=a.protocol="https:"===c.location.protocol?"https:":"http:",d=a.REQUEST_ID_KEY="request_id",a.maxUrlLength=j.is===j.Browsers.IE?2030:8e3,h=a.param=function(a,b){var d;return d=n.isString(b)||n.isNumber(b)?b:c.JSON.stringify(b),""+encodeURIComponent(a)+"="+encodeURIComponent(d)},l=function(a,b){return a.match(/^\/\//)&&(a=i+a),b.length>0?""+a+"?"+b.join("&"):a},g=n.compose(function(b){return b.length>a.maxUrlLength},l),f=function(a,b){return[""+d+"="+b].concat(a)},e=function(a){return""+a+"&pageview=false"},k=a.srcs=function(a){var b,c,d,e,i,j,k,o,p,q,r,s,t;if(a=n.clone(a),o=a.url=a.url||"no_url",j=m(),k=n.partial(l,o),c=n.partial(g,o),i=function(){var b,c;b=a.data,c=[];for(d in b)p=b[d],c.push(h(d,p));return c}(),a.noClip)return[k(i)];for(b=function(a,d){var e;for(d=d||[],e=[],a=f(a,j);c(a)&&a.length;)e.push(a.pop());return d.push(a),e.length>0&&a.length>0?b(e,d):(1===d.length&&d[0].shift(),d)},s=b(i),t=[],q=0,r=s.length;r>q;q++)e=s[q],t.push(k(e));return t},a.src=function(b){var c;return c=k(b),c.length>1&&n.fire("http:error",{code:"overflow",message:"Too many params for a single URL (max = "+a.maxUrlLength+").\nUsing first URL chunk; use http#srcs instead to handle long URLs"}),n.head(c)},a.willClip=function(b){var c;return c=a.src(n.extend({noClip:!0},b)),c.length>a.maxUrlLength&&c.length-a.maxUrlLength},a.pixel=function(a){var b,d,f,g,h;try{for(h=k(a),b=f=0,g=h.length;g>f;b=++f)d=h[b],(new c.Image).src=b>0?e(d):d;n.fire("http:pixel",a)}catch(i){}},a.jsonp=function(a){return b("http-jsonp").call(a)}})}.call(this),function(){a("impression",function(a,b){var c,d,e;e=b("util"),c=b("pixel"),b("data"),d=a.send=function(a){e.set("url_pixel",a.url),c.sendImpl(a)},a.init=function(a){d(a)}})}.call(this),function(){a("index",function(a,b){b("init")})}.call(this),function(){!function(b){var c;return c=b,window.postscribe=null,a("init",function(a,b,d){var e;e=d.Krux||((d.Krux=function(){d.Krux.q.push(arguments)}).q=[]),e.postscribe=d.postscribe,d.postscribe=c,(!e.commit||e.ns)&&(e.commit=e.commit||1,d.Krux=function(a,c){var f,g;c.params=c.params||{},g=c.params.control_tag_namespace,d.Krux=e,f=b("ns").init(g,function(){return b("routes").call}),f&&("marketer"===c.params.client_type?b("marketer")(f,c):b("publisher")(f,c))})})}(window.postscribe)}.call(this),function(){a("jslog",function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q;q=b("util"),f=b("dom"),k=b("http"),o=b("sniff"),e=c.location.search.indexOf("kxdebug")>-1,h=[],n=[],j=function(a){if(c.console&&e,q.happened("jslog.pixel")){if(a.msg===n[n.length-1])return;if(n.length>10*Math.random())return;n.push(a.msg),a.type+="-postload",h.push(a),k.pixel(i()),h=[]}else h.push(a)},m=function(a){var b;return b=/https*:\/\/([^\/]+)\/([^?\/]+)/.exec(a),b&&"apiservices.krxd.net"===b[1]?"service:"+b[2]:b&&b[1].indexOf("krxd.net")>-1?"controltag":""},g=a.errorTypes=["controltag","tag","test","http","js"],l=c.onerror||function(){return!1},c.onerror=function(a,b,d){var e,f;try{return"string"!=typeof a?l.apply(c,arguments):(f=m(b)||"js",j({type:f,url:b,line:d,msg:a}),l.apply(c,arguments))}catch(g){e=g,c.console}return l.apply(c,arguments)},p=a.sortByPriority=function(a){var b;return b=function(a){var b;return b=q.indexOf(g,a.type),-1!==b?b:g.length},q.clone(a).sort(function(a,c){var d,e;return d=b(a),e=b(c),e>d?-1:d>e?1:0})},q.on("tag:fail",function(a){j({type:"tag",tagid:a.id,msg:a.error})}),q.on("test:fail",function(a){j({type:"test",msg:a.code+":"+a.data})}),d=void 0,i=a.getPixelOptions=function(a){var b,e;for(b=a||{url:q.get("url_log"),data:{control_tag_version:c.Krux.version,commit:c.Krux.commit,pubid:q.get("pubid"),siteid:q.get("siteid"),site_name:q.get("site"),browser_bucket:o.bucket,version_bucket:d,lang:o.lang,log_version:1.1,errors:p(h)}},e=b.data.errors;k.willClip(b)&&e.length;)e.pop();return b},q.on("test:all_done",function(){var a;a="alpha"===q.get("config_param_control_tag_version")?1:.1,h.length>0&&q.rate(a)&&(k.pixel(i()),q.fire("jslog.pixel",{errors:h.length}),h=[])}),q.on("http:error",function(a){j({type:"http",msg:a.code+": "+a.message})})})}.call(this),function(){a("kxinterchange",function(a,b,c){!function(){var a,d,e,f;e=function(a){var b,d,e,f;return e=function(){try{return this.localStorage}catch(a){return b=a,null}}.call(this),d="kx"+a,((f=e)?f[d]||"":(f=c.document.cookie)&&(f=f.match("\\b"+d+"=([^;]*)"))&&decodeURIComponent(f[1]))||""},f=b("util"),a=c.Krux,d={Krux:{user:a.user,segments:a.segments,dartKeyValues:a.dartKeyValues},store:{user:e("user"),segs:e("segs")}},b("test").module("kxinterchange-support-snippet",function(b){var c,e,f,g,h,i;for(b.eq("Krux.user exported",d.Krux.user,d.store.user),e=d.store.segs,b.eq("Krux.segments exported",d.Krux.segments,e&&e.split(",")||[]),i=d.Krux.segments,g=0,h=i.length;h>g;g++)c=i[g],b("Krux.dartKeyValues contains segment "+c,a.dartKeyValues.indexOf("ksgmnt="+c)>=0);f=d.store.user,f&&b("Krux.dartKeyValues contains user",a.dartKeyValues.indexOf("u="+f)>=0)})}()})}.call(this),function(){a("marketer",function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u;return u=b("util"),g=b("config"),h=b("dom"),i=b("fingerprint"),k=b("impression"),n=b("privacy"),o=b("data-rewrite").tag,p=b("routes"),q=b("sizzle"),r=b("store"),s=b("tag"),t=b("timing"),d="data-kx-id",e=/^https?:\/\/([a-z0-9_\-\.]+\.)?krxd\.net(:\d{1,5})?(\/|$)/i,f=function(a,b){return h.attr(b,d,a),b},j=a.getParams=function(a){return u.urlParams(h.attr(a,"src"))},m=a.next=function(a){var b;if(b=u.find(q.find("script[src*="+a+"]"),function(a){return!h.attr(a,d)&&e.test(a.src)}),!b)throw new Error("No node found for "+a);return b},l=function(a,d){var e,l,q,v,w,x,y,z,A,B,C;if(x=new Date,e=g(d),l=e.get("confid"),C=l+"-"+x.getTime(),t.start(),s.claimOneTimers(e.get("tags")),u.set("tags",e.get("tags")||[]),b("jslog"),q=b("data"),q.user_attr=q.namespace("user_attr"),q.page_attr=q.namespace("page_attr"),b("scrape"),b("dataprovider"),b("events"),w=f(C,m(l)),y=j(w),z=e.get("services"),!z||!z.impression)throw new Error("impression service not specified");return y.url=z.impression,u.set("confid",l),u.set("pubid",u.get("pubid")||e.get("publisher.uuid")),e.get("params.no_pii")&&(u.set("pixel_data__knopii",1),q.user_attr("kx_lang",null),q.user_attr("kx_tech_browser_language",null)),b("test").init(),b("test-visualtags").init(),u.set("tags",e.get("tags")),u.set("config",e.toJSON()),u.set("version_bucket",e.get("params.control_tag_version")),u.set("max_segments",e.get("params.max_segments")),u.set("prioritized_segments",e.get("prioritized_segments")),q.namespace("config_param",e.get("params")),v=!/localStorage/.test(u.get("config_param_client_side_storage")),b("store").init(v),n(),b("geo")(),h.safeMode()?(u.onOnce("dom:load",u.bind(u.fireOnce,null,"report")),void t.end()):(e.get("params.fingerprint")&&!n.isOptOut()&&i(r),B=function(){var a,b,c,d;for(c=u.get("tags")||[],d=[],a=0,b=c.length;b>a;a++)A=c[a],d.push(o(A));return d}(),u.set("tags",B),u.set("config_segments",e.get("realtime_segments")),u.onOnceAll("dom:load tag:all_done",function(){u.fireOnce("report")}),b("adm-events").check3rdParty(),b("stats"),b("social"),p.api(),e.has("context_terms")&&u.onOnce("dom:load",function(){b("context-terms").process(e.get("context_terms"))}),y._kpid=u.get("pubid"),k.init(y),c.setTimeout(s.init,250),void t.end())},u.extend(l,a)})}.call(this),function(){a("ns",function(b,c,d){var e,f,g,h,i,j,k;k=c("util"),j=c("version"),f=d.Krux,g=b.NS_RE=/^ns:([\w\W]+)/,e=b.DEFAULT_NS="_default",i=b.parseArgs=i=function(a){var b,c,d;return c=a[0],d=void 0,b=c.match(g),b?(c=b[1],d=k.rest(a)):(c=e,d=a),{nsName:c,rest:d}},h=function(b){var e;return e={version:j.version,commit:j.commit,require:c,define:a,_:k},k.extend(b,e),b.isDefault&&k.extend(d.Krux,e),b},b.router=f.nsRouter||function(){var a;return a=function(){var b,c;return b=i(arguments),c=a.ns[b.nsName],b.rest.length?c?c.apply(c,b.rest):void a.q.push(arguments):c},a.ns={},a.q=[],a.defineNamespace=function(b,c){var d,f,g,h,i,j;if(f=b||e,a.ns[f])return a.ns[f];for(g=a.ns[f]=c(b),k.extend(g,{nsName:f,isDefault:f===e,path:"Krux.ns."+f}),a.creator=a.creator||g,j=a.q.splice(0,a.q.length),h=0,i=j.length;i>h;h++)d=j[h],a.apply(null,d);return g},a.nsRouter=a,k.extend(a,f),d.Krux=a}(),b.init=function(a,c){var d;return d=b.self=b.router.defineNamespace(a,c),d&&(b.name=d.nsName,b.isDefault=d.isDefault,b.path=d.path,h(d)),d}})}.call(this),function(){a("pixel",function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v;v=b("util"),n=b("http"),g=b("config")(),i=b("dom"),h=b("data"),j=b("feature"),s=b("sniff"),t=b("store"),o=b("privacy"),d=c.Krux,q=a.sendImpl=function(a){var b,c,d,e,f;c={};for(b in a)f=a[b],(f=k(b,f))&&(c[b]=f);e=v.get("config_param_control_tag_pixel_throttle"),d=100*Math.random(),e&&d>e||(n.pixel({url:v.get("url_pixel"),data:c}),setTimeout(function(){return null==v.get("user")?o.fetch():void 0},500))},u=a.stringifyValue=function(a){var b;return null==a&&(a=""),v.isArray(a)?function(){var c,d,e;for(e=[],c=0,d=a.length;d>c;c++)b=a[c],e.push(u(b));return e}().join(f):a.toString()},l=a.formatters=[],e=a.addFormatter=function(a,b){l.push({test:a,formatter:b})},k=a.format=function(a,b){var c,d;return d=v.find(l,function(b){return v.isString(b.test)?b.test===a:b.test.test(a)}),(c=d?d.formatter:u)(b)},a.tuppleSeparator=":",f=a.arraySeparator=",",p=a.send=function(a,b){var c;c=m(a,b),q(c),v.fireOnce("pixel",{phase:a,data:c})},m=a.gather=function(a,f){var i,k,l,m,n,o,p,q,r,u,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O;x={source:"smarttag",fired:a,confid:v.get("confid"),_kpid:v.get("pubid"),_kcp_s:v.get("site"),_kcp_sc:v.get("section"),_kcp_ssc:v.get("subsection"),_kcp_d:v.get("domain"),_knifr:c.frames.length,_kpref_:c.document.referrer},f===!1&&(x.pageview=String(f)),1!==v.get("pixel_data__knopii")&&(x.geo_country=v.get("user_attr_kx_geo_country"),x.geo_region=v.get("user_attr_kx_geo_region"),x.geo_city=v.get("user_attr_kx_geo_city"),x.geo_dma=v.get("user_attr_kx_geo_dma")),v.size(v.get("config_segments"))&&(x.rtsegs=b("segments").realtime()),I=function(a,b){var c,d;for(c in b)d=b[c],x[a+c]=d},I("_kua_",h.user_attr()),I("_kpa_",h.page_attr()),I("",h.namespace("pixel_data")()),y=c.performance,r=y&&y.navigation,D=y&&y.timing,!r||!D||s.ff&&s.version<9||(k=function(a,b){var c;return b||(b=a+"End",a+="Start"),c=D[a]&&D[b]&&D[b]-D[a],null==c||0>c||c>3e4?-1:c},v.extend(x,{t_navigation_type:r.type,t_dns:k("domainLookup"),t_tcp:k("connect"),t_http_request:k("request"),t_http_response:k("response"),t_content_ready:k("navigationStart","domInteractive"),t_window_load:k("navigationStart","loadEventStart"),t_redirect:k("redirect")})),C=b("scrape"),G=v.happened("user_data_response"),u=b("ns"),o=u.isDefault?d:d[u.name]||{},v.extend(x,{interchange_ran:o.hasOwnProperty("user"),store_user:o.user,store_segs:o.segments,dart_user:C.dart("u"),dart_segs:C.dart("ksgmnt")||C.dart("ksg"),userdata_was_requested:!!v.happened("user_data_request"),userdata_did_respond:!!G,store_user_after:t.get("user"),store_segs_after:t.get("segs")}),G&&v.extend(x,{userdata_user:[G.kuid,G.kuid_long],userdata_segs:G.segments}),w=t.get("org_user_id"),null!=w&&""!==w?v.extend(x,{_kuid:w}):g.get("params.target_fingerprint",!1)&&!j.hasThirdPartyCookies()&&v.extend(x,{_kuid:v.get("fp_id")}),g.get("params.no_pii",!1)?v.extend(x,{browser_bucket:s.browser,browser_version:s.version}):g.get("params.fingerprint",!1)&&(m=v.get("fp"),n=v.get("fp_id"),v.extend(x,{kfuid:n,kxfp:m})),L={user:"_kua_",page:"_kpa_"};for(F in L){z=L[F],M=h[""+F+"_attr"]();for(q in M)H=M[q],x[z+q]=H}try{B=c.sessionStorage}catch(P){l=P,B=null}if(B)try{x.sview=B.krux_views=+(B.krux_views||0)+1}catch(P){}for(N=v.get("tags"),p=J=0,K=N.length;K>J;p=++J)E=N[p],(null!=(O=E.time)?O.end:void 0)&&(x["kplt"+p]=E.id,I("tag"+E.id+"_timing",{duration:E.time.duration}));return e(/tag.*_timing/i,function(){return!1}),i=b("http-jsonp").Request.all,x.jsonp_requests=function(){var a,b,c;for(c=[],a=0,b=i.length;b>a;a++)A=i[a],c.push([A.url,A.time.end-A.time.start]);return c}(),x},r=a.sendOnce=v.once(p),a.init=function(){v.onOnce("report",function(){var a;a=v.partial(r,"report"),v.happened("user_data_fetch_scheduled")?(v.onOnce("user_data_response",function(){v.defer(a)}),c.setTimeout(function(){r("user_data_timeout")},300)):a()}),v.onOnce("dom:beforeunload",function(){r("dom:beforeunload")}),v.onOnce("dom:unload",function(){r("dom:unload")}),v.on("navigation",function(a){var b;b={source:"smarttag",type:"navigation",_kpid:v.get("pubid"),_kcp_s:v.get("site"),_kcp_sc:a.section,_kcp_ssc:a.subsection},q(b)}),b("test").module("pixel",function(a){a("pixel",v.happened("pixel"))})}})}.call(this),function(){a("privacy",function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u;return u=b("util"),g=b("config"),h=b("feature"),j=b("http"),q=b("routes"),r=b("sniff"),s=b("store"),b("events"),b("data"),c="optout_",f=6*u.MONTHS,d={ATTEMPT_CHANGE:c+"attempt_change",CHANGE:c+"change",ERROR:c+"error",REQUEST:c+"request",RESPONSE:c+"response"},e=a.OPTOUT_ALLOWED_KEYS=[/^tag\d*\.day$/,"optout"],a.Events=u.clone(d),m=function(a){return u.extend({code:"success",type:"no_change",time:new Date},a)},o=!1,i=function(a){u.fire(d.REQUEST),j.jsonp({callback:"kxjsonp_optOutCheck",done:a,fail:u.partial(u.fire,d.ERROR),url:g().get("services.is_optout")})},p=function(a){var b;u.fire(d.ATTEMPT_CHANGE),b=u.partial(u.fire,d.CHANGE),h.hasThirdPartyCookies()?j.jsonp({callback:"kxjsonp_optOutChange",done:b,fail:u.partial(u.fire,d.ERROR),url:g().get("services.set_opt"+(a?"out":"in"))}):b(m({type:"optout_change"}))},n=a.optOut=function(a,b){null==a&&(a=!0),null==b&&(b=!1),a?(l()||p(a),s.allowOnly.apply(s,e),s.clear(),(!b||h.hasThirdPartyCookies())&&s.set("optout","true")):(l()&&p(a),s.allowAll(),s.remove("optout")),o=a,g().set("dnt",o)},t=function(){return"true"===("function"==typeof s.get?s.get("optout"):void 0)},k=a.isDnt=function(){var a;return r.ie&&r.version>=10?!1:(a=u.deref("doNotTrack"),null==a&&(a=u.deref("navigator.doNotTrack")),/(?:yes|1)/i.test(a))},l=a.isOptOut=function(){return Boolean(o||g().get("dnt")||t()||k())},a.handler=function(a){var b;u.fire(d.RESPONSE,a),b=a._kuid_||a.kuid,a.optout||/^(?:OPTOUT|DNT)$/i.test(a._kuid_||"")?n():(null==a||null!=(null!=a?a.optout:void 0)||null!=b)&&n(!1),null!=b&&(u.set("user",b),"function"==typeof s.set&&s.set("user",b,f))},u.extend(function(){var b;u.onOnce("dom:load",function(){return i(a.handler)}),b=function(){k()?n(!0,!0):l()&&n(),u.off(s.READY_EVENT,b)},u.onOnce(s.READY_EVENT,b),q.simple("optout",function(a,b){var c,e,f;return null==b&&(b=u.noop),null==a?l():a===l()?void b(null,m()):(e=function(){u.off(d.CHANGE,f),u.off(d.ERROR,c)},f=function(a){return b(null,a),e()},c=function(a){return b(new Error(a.message),a),e()},u.on(d.CHANGE,f),u.on(d.ERROR,c),void n(a))})},a,{Events:d,fetch:function(b){return null==b&&(b=u.noop),i(function(c){return a.handler(c),b(c)})},USER_ID_EXPIRY:f})})}.call(this),function(){a("publisher",function(a,b,c){var d,e,f,g,h,i,j,k,l,m;return d=b("config"),e=c.document,f=b("feature"),g=b("fingerprint"),i=b("privacy"),j=b("data-rewrite").tag,k=b("store"),m=b("util"),l=b("timing"),h=c.location,function(a,n){var o,p,q,r,s,t,u,v,w,x,y;return l.start(),o=d(n),r=b("dom"),b("jslog"),q=b("data"),q.user_attr=q.namespace("user_attr"),q.page_attr=q.namespace("page_attr"),v=b("routes"),b("scrape"),b("dataprovider"),b("events"),e.getElementById("kxinterchange")&&b("kxinterchange"),p=o.get("confid"),m.set("confid",p),m.set("pubid",m.get("pubid")||o.get("publisher.uuid")),m.set("domain",r.kruxDomain(h.host)),m.set("site",m.get("site")||o.get("site.name")||m.get("domain")),m.set("siteid",m.get("siteid")||o.get("site.id")),o.get("params.no_pii")&&(m.set("pixel_data__knopii",1),q.user_attr("kx_lang",null),q.user_attr("kx_tech_browser_language",null)),b("pixel").init(),b("test").init(),b("test-visualtags").init(),m.set("tags",o.get("tags")),m.set("url",c.location.href),m.set("config",o.toJSON()),m.set("version_bucket",o.get("params.control_tag_version")),m.set("max_segments",o.get("params.max_segments")),m.set("prioritized_segments",o.get("prioritized_segments")),q.namespace("url",o.get("services")),q.namespace("config_param",o.get("params")),s=!/localStorage/.test(m.get("config_param_client_side_storage")),w=k.init(s),i(),b("geo")(),r.safeMode()?(c.console,m.onOnce("dom:load",m.bind(m.fireOnce,null,"report")),void l.end()):(o.get("params.fingerprint")&&!i.isOptOut()&&g(k),u=o.get("params.user_id_cookie"),t=k.cookie.get(u),null!=u&&t&&!f.hasThirdPartyCookies()?(w.set("org_user_id",t),m.set("user",t)):w.remove("org_user_id"),y=function(){var a,b,c,d;for(c=m.get("tags")||[],d=[],a=0,b=c.length;b>a;a++)x=c[a],d.push(j(x));return d}(),m.set("tags",y),m.set("config_segments",o.get("realtime_segments")),m.onOnceAll("dom:load tag:all_done",function(){m.fireOnce("report")}),b("adm-events").check3rdParty(),b("stats"),b("social"),v.api(),o.get("context_terms")&&m.onOnce("dom:load",function(){b("context-terms").process(o.get("context_terms"))}),b("tag").init(),o.get("params.recommend")&&b("recommend"),void l.end())}})}.call(this),function(){a("recommend",function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q;return e=604800,d=2500,q=b("util"),i=b("dom"),p=b("store"),h=b("config")(),m=b("routes"),b("data"),g=function(a){var c,d;return null!=a&&(d=i.byId(a)),null!=d&&(c=i.text(d)),null==c&&(c='<ul>{{#entry}}<li><a href="{{actionlink}}">{{title}}</a> - {{description}}</li>{{/entry}}</ul>'),b("hogan-3").compile(c)},f=function(a){var b;null!=a&&(b=c.document.createElement("link"),b.rel="stylesheet",b.type="text/css",b.href=a,i.append(i.head(c.document),b))},l=function(a){var b,c;for(b in a)c=a[b],(null==c||""===c)&&delete a[b];return a},j=function(){return{entry:[]}},o=function(a){return q.get("url_contentConnector")+a},n=function(a){return p.set("rec",c.JSON.stringify(a),e)},k=function(){var a;return a=p.get("rec"),null!=a?c.JSON.parse(a):j()
},m.simple("recommend",function(a,e){var r,s,t,u,v,w,x,y,z,A,B,C,D,E;if(h.get("params.recommend")){if(e=q.defaults(e||{},{test:0,links:5,template:null,filter:"",content_type:"article",click_event:"",impression_event:""}),r="type=='"+e.content_type+"'",e.filter=e.filter.length&&r.length?"("+e.filter+(") and ("+r+")"):r,(y=/^(before|after|inside):(.+)$/.exec(a))?(w=y[1],a=y[2]):w="inside",E=b("sizzle").find(a),!E)throw new Error("Could not find target element for '"+a+"'");return E=E[0],A=q.get("pubid"),C=p.get("allsegs",""),s=""+window.location.protocol+"//"+window.location.host+"/"+window.location.pathname,B=function(a,b){var d,h,k,l,n,o,p,r,s,t,u;for(null!=a&&c.clearTimeout(a),q.defaults(b,{ad:j(),user:j(),item:j()}),q.shuffle(b.user.entry),q.shuffle(b.item.entry),r=j(),r.entry=[].concat.apply([],[b.user.entry.slice(0,e.links),b.item.entry.slice(0,e.links),b.ad.entry.slice(0,e.links)]),q.shuffle(r.entry),r.entry=r.entry.slice(0,e.links),d=e.click_event?"&kx_event_uid="+e.click_event:"",h="http://apiservices.krxd.net/click_tracker/track?kx_cc=1"+d+"&clk=",l={},k=1,u=r.entry,s=0,t=u.length;t>s;s++)n=u[s],l["url"+k]=n.actionlink,k+=1,n.actionlink=h+encodeURIComponent(n.actionlink);r.entry.length>0&&(f(e.stylesheet),o=g(e.template).render(r),"inside"===w?E.innerHTML=o:(p=c.document.createElement("div"),p.innerHTML=o,"before"===w?i.before(E,p):"after"===w&&i.after(E,p)),e.impression_event&&m.call("admEvent",e.impression_event,q.extend({event_type:"ccvw"},l)))},z=function(a,b,c){return q.defaults(b,c),null!=b.ad&&null!=b.item&&null!=b.user?B(a,b):void 0},D=function(a){return c.setTimeout(function(){return z(null,a,{user:k()})},d)},v=function(a,d){var f;return null!=q.get("url_contentConnector")?(f=l({pubid:A,lang:c.navigator.language,filter:e.filter,seg:C,nv:"1.0",ni:e.links}),b("http").jsonp({url:o("user"),callback:"kxjsonp_contentConnectorUser",data:f,done:function(b){n(b),z(a,d,{user:b})},fail:function(){z(a,d,{user:k()})}})):z(a,d,{user:j()})},u=function(a,d){var f;return h.get("params.content_connector_items")&&null!=q.get("url_contentConnector")?(f=l({pubid:A,lang:c.navigator.language,filter:e.filter,url:s,nv:"1.0",ni:e.links}),b("http").jsonp({url:o("item"),callback:"kxjsonp_contentConnectorItem",data:f,done:function(b){z(a,d,{item:b})},fail:function(){z(a,d,{item:j()})}})):z(a,d,{item:j()})},t=function(a,d){var f,g,i;return h.get("params.content_connector_ads")&&null!=q.get("url_contentConnector")?(g=b("flash").version(),i=b("geo"),f=l({allimps:1,test:e.test,pubid:A,site_id:q.get("siteid"),url:s,cat:e.cat,search:e.search,utc:(new Date).getTimezoneOffset(),lang:c.navigator.language,fv:[g.major,g.minor].join("."),h:c.screen.height,w:c.screen.width,co:i.get("country"),st:i.get("region"),met:i.get("dma"),pcode:i.get("zip"),seg:C,nm:(e.fields||[0,1,2,3]).join(","),nv:"1.0",ni:e.links,filter:e.filter}),b("http").jsonp({url:o("ad"),callback:"kxjsonp_contentConnectorAd",data:f,done:function(b){z(a,d,{ad:b})},fail:function(){z(a,d,{ad:j()})}})):z(a,d,{ad:j()})},(x=function(){var a,b;return a={},b=D(a),v(b,a),u(b,a),t(b,a)})()}})})}.call(this),function(){a("rollout",function(a,b){var c,d,e;return e=b("util"),d=b("store"),c="ro_",function(a,b,f){var g,h,i,j;return null==b&&(b=.001),null==f&&(f=6*e.MONTHS),g=""+c+a,i=e.param(a),h=null!=i?/1|true/.test(i):void 0,j=e.rate(b)||"1"===d.get(g,"0"),null!=h&&(j=h),j?d.set(g,"1",f):d.remove(g),j}})}.call(this),function(){a("routes",function(b,c,d){var e,f,g,h,i,j,k,l,m,n,o;o=c("util"),h=c("ns"),l=b.routes=[],i=b.q=d.Krux&&d.Krux.q||[],g=b.getHandler=function(a){var b,c,d;for(c=0,d=l.length;d>c;c++)if(b=l[c],b[0].test(a))return b},f=b.call=function(a){var b,d,e;return b=arguments,h.NS_RE.test(a)&&(d=h.router(a),null!=d)?o.size(b)>1?d.apply(d,o.tail(b)):d:o.isFunction(a)?a.call(null,c):(e=g(a))?e[1].apply(null,b):void i.push(o.toArray(b))},n=b.understands=function(a){return!!g(a)},k=b.replay=function(){var a,b,c,d;for(b=o.clone(i),i.length=0,c=0,d=b.length;d>c;c++)a=b[c],f.apply(null,a)},e=b.add=function(a,b){l.push([a,b]),k()},j=b.regexp=function(a,b){e(a,function(c){return b.apply(this,[c.match(a)].concat(o.rest(arguments)))})},m=b.simple=function(a,b){var c;c=new RegExp("^"+a+"$"),j(c,function(){return b.apply(null,o.rest(arguments))})},b.once=function(a,c){var d;d=function(){return l=b.routes=o.remove(l,d),c.apply(this,arguments)},m(a,d)},b.namespace=function(a,b){var c;c=new RegExp("^"+a+"\\.(.*)"),j(c,function(a){b[a[1]].apply(b,o.rest(arguments))})},b.api=function(){j(/^fire:(.+)/,function(a,b){return o.fire(a[1],b)}),j(/^on:(.+)/,function(a,b){return o.on(a[1],b)}),j(/^fireOnce:(.+)/,function(a,b){return o.fireOnce(a[1],b)}),j(/^onOnce:(.+)/,function(a,b){return o.onOnce(a[1],b)}),j(/^require:?(.*)/,function(a,b){return a[1]?c(a[1]):b?c(b):c}),m("define",a),m("JSON.stringify",d.JSON.stringify),m("log",o.log),m("page:load",function(a,b){var e,g;g=c("pixel");try{o.set("url",String(d.location)),f("tag:reload",function(c){a&&a(c),g.send("ajax",b&&b.pageView)})}catch(h){e=h,a&&a(e)}})},m("understands",n)})}.call(this),function(){a("scrape",function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r;p=b("util"),f=b("data"),n=b("sizzle"),l=b("routes"),h=b("dom"),g=a.defaultExcludes=["sz","dcopt","ord","tile","pos","uri","click","ksgmnt","null","undefined"],q=a._dart=function(){var b,d,e,g,h,i,j,k,l,m,o,q,r,s,t,u,v,w,x,y;for(g=function(a){return n.find("script[src*="+j+"]",a).concat(n.find("iframe[src*="+j+"]",a))},j=".doubleclick.net",u={},e=[],e=e.concat(g(c.document)),i=n.find("iframe[src*=://"+c.location.hostname+"]").concat(n.find("iframe[src^=/]")),v=0,x=i.length;x>v;v++){h=i[v];try{b=h.contentWindow.document,e=e.concat(g(b))}catch(z){}}for(a.dartElements=e,w=0,y=e.length;y>w;w++){d=e[w],t=n.attr(d,"src"),m=t.match(/[^;]*;(.*)/),l=m&&m[1],q=p.parseKeyValues(l,";");for(k in q)o=q[k],r=u[k],r&&r!==o?(p.isArray(r)||(r=[r]),p.isArray(o)?r=r.concat(o):r.push(o),u[k]=p.uniq(r)):u[k]=o}return d=e[0],d&&(t=n.attr(e[0],"src"),m=t.match(/\.doubleclick\.net(\/[^;]*)/),s=m?m[1]:"",f.page_attr({dfpsite:s.split("/")[2],dfpzone:s.split("/")[3]})),u},e=void 0,d=function(a){var b,c,d,h,i,j,k;if((!e||p.isEmpty(e))&&(e=q()),b=new p.Set(a&&a._excludes||g),null==a)return e;if(p.isString(a))return e[a];k=[];for(c in a)i=a[c],h=f.namespace(c),k.push(p.isArray(i)?function(){var a,b,c;for(c=[],a=0,b=i.length;b>a;a++)d=i[a],c.push(e[d]?h(d,e[d]):void 0);return c}():"*"===i?function(){var a;a=[];for(d in e)j=e[d],a.push(b[d]?void 0:h(d,j));return a}():p.set(c,e[i]));return k},j=a.extensions={},i=a.extension=function(b,c){return j[b]=a[b]=c,l.simple("scrape."+b,c),c},r={dart:d,dom:function(a){var b,c,d;return b=a.match(/^(.+):([^:]+)$/),c=n.find(b[1])[0],d=b[2],c&&d&&("text"===d?h.text(c):"value"===d?h.value(c):"@"===d.charAt(0)&&h.attr(c,d.substr(1)))},link_rel:function(b){return a.dom("link[rel="+b+"]:@href")},link_rev:function(b){return a.dom("link[rev="+b+"]:@href")},meta_name:function(b){return a.dom("meta[name="+b+"]:@content")},meta_property:function(b){return a.dom("meta[property="+b+"]:@content")},opengraph:function(b){return a.meta_property("og:"+b)},url_path:function(b){return a.location.pathname.split("/")[b]},url_param:function(b){var c;return c=a.location.href.match("\\b"+b+"(?:=|\\b)([^&]*)"),c&&(decodeURIComponent(c[1])||!0)},url_hash:function(a){return[""].concat(String(c.location.hash).replace(/^(?:#|\/){0,}/,"").split("/"))[a]},url_host:function(b){return a.location.hostname.split(".").reverse()[b-1]},url_domain:function(b){return p.last(a.location.hostname.split("."),b).join(".")},cookie:function(a){var b;return b=c.document.cookie,b&&(b=b.match("\\b"+a+"=([^;]*)"))&&decodeURIComponent(b[1])},data:function(a){return p.get(a)},javascript:function(a){var b;try{return c.eval(a)}catch(d){b=d,p.fire("error",b)}},js_global:function(a){var b,d;try{for(d=c,b=a.split(".");d&&b[0];)d=d[b.shift()];return d}catch(e){}}};for(k in r)o=r[k],i(k,o);a.location=c.location,m=a.scrape=function(a){var b,c,d,e,f;e={};for(d in a){c=a[d],b=void 0;for(k in c)if(null!=j[k]){b=k;break}if(null==b){p.fire("error",{message:"No extension found",scrape:a});break}f=j[b](c[b]),e[d]=f}return e},l.simple("scrape",function(a){var b;return b=m(a),p.set(b),b})})}.call(this),function(){var b=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};a("segments",function(a,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y;y=c("util"),f=c("cache"),i=c("config")(),j=c("data"),s=c("privacy"),v=c("rollout"),x=c("store"),q=y.param("segs"),null!=q&&y.set("user_segments",q.split(",")),d=a.allRealtime=y.pluck(y.get("config_segments"),"id"),n=c("expression").eval,u=a.realtime=function(){var a,b,c,d,e,f,g;if(s.isOptOut())return[];for(d=[],g=y.get("config_segments")||[],b=24*x.HOURS,c=0,f=g.length,a=void 0,e=void 0;f>c;)a=g[c],e="rt_"+a.id,n(a.test)&&x.set(e,"1",b),x.get(e)&&d.push(a.id),++c;return d},r=a.prioritizedSegments=function(){return y.get("prioritized_segments")||[]},o=a.maxSegments=function(){return y.get("max_segments")||0},g=a.compute=function(){var a,c,e,f,g,h,i,j;return s.isOptOut()?(y.set("user_segments",[]),x.set("segs",""),y.set("all_user_segments",[]),void x.set("allsegs","")):void(q||(i=x.get("segs"),i=i?i.split(","):[],j=y.difference(i,d),y.set("user_segments",j),g=u(),c=g.concat(j),y.set("all_user_segments",c),x.set("allsegs",c.join(",")),y.set("user_segments",c),x.set("segs",c.join(",")),f=r(),e=o(),f.length>0&&e>0&&c.length>e&&(a=function(){var a,d,e;for(e=[],a=0,d=f.length;d>a;a++)h=f[a],b.call(c,h)>=0&&e.push(h);return e}().slice(0,e),y.set("user_segments",a),x.set("segs",a.join(",")))))},m=a.handleUserDataResponse=function(a){a.segments&&x.set("segs",a.segments.join(","),72*x.HOURS),a.shared_segments&&(x.set("shared_segments",a.shared_segments.join(","),72*x.HOURS),y.set("user_shared_segments",a.shared_segments)),a.kuid&&(x.set("user",a.kuid,s.USER_ID_EXPIRY),y.set("user",a.kuid)),a.technographics&&(x.set("tech",y.paramString(a.technographics),30*x.DAYS),t()),a.fp_id&&x.set("fp_id",a.fp_id),g(),y.fire("user_data_response",a)},t=a.readTechFromStore=function(){var a,b,c,d;if(b=x.get("tech")){if(1!==y.get("pixel_data__knopii")){d=y.parseKeyValues(b);for(a in d)c=d[a],y.set("user_attr_kx_tech_"+a,c)}return!0}return!1},l={url:y.get("url_userData"),data:{pubid:y.get("pubid")},callback:"kxjsonp_userData",done:m},p=x.get("org_user_id"),p&&(l.data._kuid=p),i.get("params.fingerprint",!1)&&v("fp")&&(l.data.kxfp=y.get("fp"),l.data.kfuid=y.get("fp_id")),t()||(l.data.technographics=1),k=a.fetch=function(){y.fireOnce("user_data_request"),c("http").jsonp(l)},y.get("segWait")||(y.set("segWait",1,5*x.MINUTES),y.onOnce("dom:load",k),y.fire("user_data_fetch_scheduled")),x.get("segs"),x.get("allsegs"),g(),w=[],x.get("shared_segments")&&(w=x.get("shared_segments").split(",")),y.set("user_shared_segments",w),e=x.get("allsegs")?x.get("allsegs").split(","):[],y.set("all_user_segments",e),h=y.throttle(g,100),j.user_attr.change(h),j.page_attr.change(h),j.namespace("event").change(g),c("test").module("segments",function(a){y.happened("user_data_fetch_scheduled")&&a("user_data_response",y.happened("user_data_response"))})})}.call(this),function(){var b=function(a,b){return function(){return a.apply(b,arguments)}};a("sha1",function(a,c){var d,e,f,g,h,i;return g=c("crypto-util"),i=c("routes"),f=[],d={20:1518500249,40:1859775393,60:1894007588,80:899497514},e=function(){function a(a){this._message=null!=a?a:"",this._process=b(this._process,this),this._append=b(this._append,this),this.update=b(this.update,this),this.reset=b(this.reset,this),this.clone=b(this.clone,this),this.toString=b(this.toString,this),this.finalize=b(this.finalize,this),this.reset(),this._append(this._message)}return a.prototype._minBufferSize=0,a.prototype.finalize=function(){var a,b,c;return c=this._data,a=g.calculateSigBytesForWords(c),b=8*a,c[b>>>5]|=128<<24-b%32,c[(b+64>>>9<<4)+14]=Math.floor(b/g.MAX_WORD),c[(b+64>>>9<<4)+15]=b,this._process(),String(this)},a.prototype.toString=function(){return g.fromWordsToHex(this._hash)},a.prototype.clone=function(){var b;return b=new a(this._message),b._hash=this._hash.slice(0),b},a.prototype.reset=function(){return this._hash=this._getInitial(),this._data=[],this},a.prototype.update=function(a){return this._append(a),this},a.prototype._append=function(a){var b;return this._message+=a,b=g.fromUtf8ToWords(a),this._data.push.apply(this._data,b),this},a.prototype._process=function(){var a,b,c,d,e,f,h,i;if(i=this._data,c=i.length*g.BYTES_PER_WORD,a=16,b=4*a,d=c/b,e=d*a,h=void 0,e){for(f=0;e>f;)this._processBlock(i,f),f+=a;h=i.splice(0,e)}return h},a.prototype._processBlock=function(a,b){var c,e,g,h,i,j,k,l,m;for(c=this._hash,e=c[0],g=c[1],h=c[2],i=c[3],j=c[4],k=0;80>k;)16>k?f[k]=0|a[b+k]:(l=f[k-3]^f[k-8]^f[k-14]^f[k-16],f[k]=l<<1|l>>>31),m=(e<<5|e>>>27)+j+f[k],m+=20>k?(g&h|~g&i)+d[20]:40>k?(g^h^i)+d[40]:60>k?(g&h|g&i|h&i)-d[60]:(g^h^i)-d[80],j=i,i=h,h=g<<30|g>>>2,g=e,e=m,k++;c[0]=c[0]+e|0,c[1]=c[1]+g|0,c[2]=c[2]+h|0,c[3]=c[3]+i|0,c[4]=c[4]+j|0},a.prototype._getInitial=function(){var a;return a=[1732584193,4023233417,2562383102,271733878,3285377520],function(){return a.slice(0)}}(),a}(),h=function(a){return new e(a).finalize()},i.simple("hash:sha1",h),h})}.call(this),function(){a("sizzle",function(a,b,c){var d,e,f,g,h,i,j,k;k=b("util"),g=b("dom"),e=/^(?:(\w+)|(\*(?=\W|$))|\.([\w\-]+)|#([\w\-]+))([#\.\w\-]*)/,d=/^\[([\w\-]+)(?:(\W?=)(["']?)([^\]]*)\3(["']?))?\]/,f=a.attr=g.attr,j=a.hasAttr=function(a,b){var c;return a.hasAttribute?a.hasAttribute(b):!(!(c=a.attributes[b])||!c.nodeValue)},h=function(a,b,c,d){var e,g,h,i,l,m,n;for(h=function(a){return function(c){return!!f(c,b).match(a)}},e=d&&k.escapeRegexp(d),i=c?"="===c?function(a){return f(a,b)===d}:"!="===c?function(a){return f(a,b)!==d}:"*="===c?function(a){return f(a,b).indexOf(d)>=0}:"~="===c?h("(^|\\s)"+e+"(\\s|$)"):"|="===c?h("^"+e+"\\b"):"$="===c?h(e+"$"):"^="===c?h("^"+e):"false":function(a){return j(a,b)},n=[],l=0,m=a.length;m>l;l++)g=a[l],i(g)&&n.push(g);return n},i=a.getElementsByClassName=function(a,b){return k.isString(a)&&(b=a,a=c.document),a.getElementsByClassName?a.getElementsByClassName(b):h(a.getElementsByTagName("*"),"class","~=",b)},a.find=function(a,b){var f,g,j,l,m,n,o,p,q,r,s,t;for(t=function(){throw new Error("Error parsing selector query: "+a)},b=b||c.document,k.isArray(b)||(b=[b]),f=b,s=[],r=void 0,l=0,j=function(a,b){return b[1]?k.toArray(a.getElementsByTagName(b[1])):b[2]?k.toArray(a.getElementsByTagName("*")):b[3]?k.toArray(i(a,b[3])):b[4]&&(b=a.getElementById(b[4]))?[b]:[]},g=function(){s=s.concat(f===b?[]:f),f=b},q=function(a,b){return function(){var c;return(c=r.match(a))?(b(c),c[0].length):0}},o=q(e,function(a){var b,c,d,e,g,i;for(c=[],g=0,i=f.length;i>g;g++)d=f[g],c=c.concat(j(d,a));for(f=c,e=a[5]||"";b=e.match(/^([\.#])([\w\-]+)/);)f="."===b[1]?h(f,"class","~=",b[2]):h(f,"id","=",b[2]),e=e.slice(b[0].length);if(e)throw new Error("parse error")}),m=q(d,function(a){f=h(f,a[1],a[2],a[4])}),p=q(/\s*/,function(){}),n=q(/,/,g);r=a.slice(l);)l+=o()||m()||n()||p()||t();return g(),s}})}.call(this),function(){a("sniff",function(a,b,c){var d,e,f,g;return g=b("util"),e="0",d={CHROME:"Chrome",FIREFOX:"Firefox",IE:"IE",OPERA:"Opera",OTHER:"Other",PHANTOM:"Phantom",SAFARI:"Safari"},f=function(a,b){var f,h,i,j,k,l,m,n,o,p;return null==a&&(a=null!=(p=c.navigator)?p.userAgent:void 0),null==b&&(b=c.navigator),l=function(b){var c;switch(null==b&&(b=a),c=g.partial(g.matchAll,b),!1){case!(c("Chrome","OPR")||c("Presto")):return d.OPERA;case!(c("Chrome")||c("CriOS")):return d.CHROME;case!(c("Trident","Windows")||c("MSIE")):return d.IE;case!c("PhantomJS"):return d.PHANTOM;case!((c("Safari","like Gecko")||c("iPhone")||c("iPad"))&&!c("Linux")&&c("KHTML")):return d.SAFARI;case!c("Gecko","Firefox"):return d.FIREFOX;default:return d.OTHER}},n=function(b,c){var f;switch(null==c&&(c=a),f=function(a){var b;return null!=(b=c.match(a))?b[1]:void 0},!1){case b!==d.SAFARI:return f(/Version\/(\d+)/i);case b!==d.CHROME:return f(/(?:Chrome|CriOS)\/(\d+)/i);case b!==d.IE:return f(/(?:MSIE\s|rv:)(\d+)/i);case b!==d.FIREFOX:return f(/Firefox\/(\d+)/);case b!==d.OPERA:return f(/(?:OPR|Version)\/(\d+)/);case b!==d.PHANTOM:return f(/(?:PhantomJS)\/(\d+)/);default:return e}},m=function(){var a,c,d,e,f;for(f=["language","systemLanguage","browserLanguage","userLanguage"],d=0,e=f.length;e>d;d++)if(a=f[d],c=null!=b?b[a]:void 0,null!=c)return c.substring(0,2);return""},f=l(),o=n(f),k=f===d.IE,i=function(a){return k&&o===""+a},j=f===d.FIREFOX,{UNKNOWN_VERSION:e,Browsers:d,browser:f,bucket:function(){switch(!1){case!k:return"IE."+o;case!j:return h=Number(o)<4?"3x":"4plus",""+f+"."+h;default:return f}}(),is:f,ff:j,ie:k,ie6:i(6),ie7:i(7),ie8:i(8),ie9:i(9),ie10:i(10),ie11:i(11),lang:m(),msie:k,parse:function(b){return null==b&&(b=a),f=l(b),{browser:f,version:n(f,b),language:m()}},ua:a.toLowerCase(),version:o}},g.extend(f,f())})}.call(this),function(){a("social",function(a,b,c){var d,e,f,g,h,i;i=b("util"),i.on("social",function(a){var d;d=i.rewriter({facebook:"fb",twitter:"twttr"}),b("http").pixel({url:i.get("url_social"),data:{_kpid:i.get("pubid"),_kcp_s:i.get("site"),_ksoc_t:d(a.provider),_ksoc_e:a.action,_ksoc_url:a.url,_kpa_title:c.document.title}})}),e=function(a,b,c){i.fire("social",{provider:a,action:b,url:c})},d=function(a,b){e("facebook",a,b)},h=function(a){e("twitter","tweet",a)},f=a.init_facebook=function(){var a;a=(a=c.FB)&&(a=a.Event)&&a.subscribe&&i.bind(a.subscribe,a),a?(a("edge.create",i.bind(d,null,"like")),a("edge.remove",i.bind(d,null,"unlike")),a("message.send",i.bind(d,null,"send")),a="done"):a="fail",i.fire("social.init_facebook",{status:a})},g=a.init_twitter=function(){var a;a=(a=c.twttr)&&(a=a.events)&&a.bind&&i.bind(a.bind,a),a?(a("tweet",function(a){h(a&&a.target&&"IFRAME"===a.target.nodeName?a.target.src:null)}),a="done"):a="fail",i.fire("social.init_twitter",{status:a})},b("routes").simple("social.init",function(){c.setTimeout(function(){f(),g()},1e3)})})}.call(this),function(){var b=function(a,b){return function(){return a.apply(b,arguments)}};a("stateful",function(a,c,d){var e,f,g,h;return h=c("util"),e="all",g=/(?:([a-z]*):)?([^:]+)$/i,f=function(){function a(a,c){this._raw=null!=a?a:{},this._defaults=null!=c?c:{},this._mkRemover=b(this._mkRemover,this),this._addHandler=b(this._addHandler,this),this._fire=b(this._fire,this),this.toString=b(this.toString,this),this.watch=b(this.watch,this),this.remove=b(this.remove,this),this.has=b(this.has,this),this.set=b(this.set,this),this.get=b(this.get,this),this._handlers={all:[]}}return a.prototype.get=function(a){var b;return b=this._raw[a],null!=b?b:this._defaults[a]},a.prototype.set=function(a,b){var c;return c=this._raw[a],this._raw[a]=b,this._fire("set",a,c,b),this},a.prototype.has=function(a,b){return null!=this._raw[a]||b&&null!=this._defaults[a]},a.prototype.remove=function(a,b){var c,d;return c=function(b){return function(c,d){null!=d&&b._fire(c,a,d,void 0)}}(this),d=this._raw[a],delete this._raw[a],c("remove",d),b&&(d=this._defaults[a],delete this._defaults[a],c("removeDefault",d)),this},a.prototype.watch=function(a,b,c){var d,f,i,j;if(!h.isFunction(b))throw new Error("Watch expected function, but got: "+b+" \nContext: "+this);return j=void 0,d=void 0,f=a.match(g),a===e?(d="",j=a):f[1]&&f[1]!==e?(j=f[1],d=f[2]):(d=f[2],j=e,a=""+j+":"+d),i=this._mkRemover(a,b),this._addHandler(a,{context:c,fn:b,key:d,remove:i,type:j}),i},a.prototype.toString=function(){return"Stateful"+d.JSON.stringify(this._raw)},a.prototype._fire=function(a,b,c,d,f){var g,h,i,j,k,l,m,n;for(i=this._handlers,j=function(a){return a.fn.call(a.context||null,b,c,d)},g=function(b){return i[e].concat(i[""+e+":"+b]||[]).concat(i[""+a+":"+b]||[])},n=g(b),l=0,m=n.length;m>l;l++)h=n[l],k=j(h),null!=k&&((f||this._raw)[b]=k);return this},a.prototype._addHandler=function(a,b){var c;return c=this._handlers[a],c||(c=this._handlers[a]=[]),c.push(b),this},a.prototype._mkRemover=function(a,b){return function(c){return function(){var d;c._handlers[a]=function(){var c,e,f,g;for(f=this._handlers[a],g=[],c=0,e=f.length;e>c;c++)d=f[c],d.fn!==b&&g.push(d);return g}.call(c)}}(this)},a}(),h.extend(function(a,b){return new f(a,b)},{Stateful:f},a)})}.call(this),function(){a("stats",function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n;n=b("util"),k=b("sniff"),b("events"),b("data"),e={counter:{},time:{}},f=a.get=function(a,b){return e[a][b]},j=a.set=function(a,b,c){e[a][b]=c},a.time=function(a,b){j("time",a,b)},g=a.inc=function(a){var b;b=f("counter",a)||0,j("counter",a,b+1)},h=a.incPath=function(a){var b;b=a.split("."),n.times(b.length,function(a){g(n.first(b,a+1).join("."))})},l=0,c="."+k.bucket,d="."+n.get("config_param_control_tag_version"),m=d+c,h("views"+m),n.on("social",function(a){g(a.provider+"."+a.action)}),n.on("tag:done",function(){h("tags_delivered"+m)}),i=0,n.on("error",function(){var a;try{if(i>10)return;i++,h("js_errors"+m)}catch(b){return void(a=b)}}),l=".alpha"===d?1:".beta"===d||".stable"===d?.01:.001,Math.random()<l&&n.onOnce("tag:all_done",function(){var a,c,d,f;a=function(a,b,c){return"controltagv2."+b+":"+c+"|"+a},d=function(){var b,d;b=e.counter,d=[];for(c in b)f=b[c],d.push(a("c",c,f));return d}().concat(function(){var b,d;b=e.time,d=[];for(c in b)f=b[c],d.push(a("ms",c,f));return d}()).join(","),b("http").pixel({url:n.get("url_stats"),data:{q:d,format:"gif"}})})})}.call(this),function(){var b=[].slice;a("store",function(a,c,d){var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F;for(C=c("util"),A=c("whitelist"),c("events"),s=function(){try{return d.localStorage}catch(a){return o=a,null}}(),n=d.document,B=["set","get","remove","namespace"],p=B.concat(["clear"]),w="",z=a.whitelist=A(A.ALL),F=["allowAll","allowNone","allowOnly"],D=0,E=F.length;E>D;D++)t=F[D],a[t]=C.bind(z[t],z);i=C.SECONDS,g=C.MINUTES,f=C.HOURS,e=C.DAYS,C.extend(a,{SECONDS:i,MINUTES:g,HOURS:f,DAYS:e}),h=a.READY_EVENT="store:ready",y=function(a){return new Date(C.now()+1e3*a)},j=function(b){return a.prefix&&0!==b.indexOf(w)&&(b=w+b),b},x=function(b){return a.prefix?b.replace(new RegExp("^"+w),""):b},m={domain:function(a){return"; domain="+a}},q=function(a){return z.has(x(a))||z.has(a)},l=a.cookie={_COOKIE_START:"(?:^|\\s|;)",set:function(a){return q(a)?l._set.apply(l,arguments):""},get:function(a,b){var c;return null==b&&(b=""),c=""+l._COOKIE_START+a+"=([^;]*)",n.cookie&&(t=n.cookie.match(c))&&d.decodeURIComponent(t[1])||b},remove:function(a){l._set(a,0,-1)},namespace:function(a){var b,c;return b={},c=new RegExp(""+l._COOKIE_START+a+"([^=]*)=([^;]*)","g"),n.cookie.replace(c,function(a,c){b[decodeURIComponent(a)]=decodeURIComponent(c)}),b},clear:function(a){var b,c,d,e,f,g,h;for(null==a&&(a=C.yes),g=n.cookie.split(/\s*;\s*/),e=0,f=g.length;f>e;e++)c=g[e],h=c.split("="),b=h[0],d=h[1],q(b)&&a(d,x(b))||l.remove(j(b))},_set:function(a,b,c,d){var e,f;return e=c?"; expires="+y(c).toUTCString():"",f=""+a+"="+encodeURIComponent(b)+l._optionsToCookie(d)+";path=/"+e,n.cookie=f,f},_optionsToCookie:function(a){var b,c,d;c="";for(b in a)d=a[b],b in m&&(c+=m[b](d));return c}},u=function(a){var c,d,e,f,g;for(c=C.clone(a),d=function(c){return function(){var d;d=1<=arguments.length?b.call(arguments,0):[];try{return a[c].apply(a,d)}catch(e){}}},f=0,g=B.length;g>f;f++)e=B[f],c[e]=d(e);return c},r=a.local=s&&u({set:function(a,b,c){return q(a)?(s.setItem(a,b),c?s.setItem("_"+a,+y(c)):s.removeItem("_"+a),b):""},get:function(a,b){var c,d;return null==b&&(b=""),d=s.getItem(a),c=s.getItem("_"+a),c&&c<=new Date&&(d=null),d||b},remove:function(a){s.removeItem(a),s.removeItem("_"+a)},namespace:function(b){var c,d;d={};for(c in s)t=c.match("^"+b+"(.*)"),t&&(d[t[1]]=a.get(t[1]));return d},clear:function(a){var b;null==a&&(a=C.yes);for(b in s)q(b)&&a(r.get(b),x(b))||r.remove(j(b))}}),v=c("ns"),w=a.prefix="kx"+(v.isDefault?"":""+v.name+"_"),k=function(a){var c,d,e;for(c=C.clone(a),d=0,e=B.length;e>d;d++)t=B[d],c[t]=function(a,c){return function(){var d,e;return e=arguments[0],d=2<=arguments.length?b.call(arguments,1):[],null==e&&(e=""),a[c].apply(a,[j(e)].concat(b.call(d)))}}(a,t);return c},a.init=function(b){var c,d,e,f;if(d=void 0,r&&!b)try{r.set("kxtest","test"),d="test"===r.get("kxtest")&&r,r.remove("kxtest")}catch(g){}for(d=d||l,c=a.impl=k(d),e=0,f=p.length;f>e;e++)t=p[e],a[t]=c[t];return C.fire(h),c}})}.call(this),function(){a("tag-actions",function(a,b){var c,d,e,f,g,h;h=b("util"),d=b("tag-delivery"),e=b("tag-delivery-timing"),f=b("events").instance,c="tag:all_done",g=function(a,b){return function(a){var g,i,j;f.clear("tag"),i=function(){var a,c,e,f;for(e=h.get("tags"),f=[],a=0,c=e.length;c>a;a++)j=e[a],b(j)&&(d.forget(j),f.push(j));return f}(),e(i),h.on(c,g=function(){a(null),h.off(c,g)})}},a.DEFAULT="all",a[a.DEFAULT]=g("*",h.yes)})}.call(this),function(){a("tag-delivery-timing",function(a,b){var c,d,e,f,g;return g=b("util"),c=b("config"),d=b("tag-delivery"),e=b("dom"),f=a.isDone=function(a){return!!(a.time&&a.time.end||a.error||a.metCriteria===!1)},g.extend(function(a){var b,h,i,j,k;for(j=0,k=a.length;k>j;j++)i=a[j],d.uniqueName(i);return b=function(){g.all(a,f)&&(b=g.noop,g.fireOnce("tag:all_done"))},g.on("tag:done",function(){b()}),g.on("tag:fail",function(){b()}),b(),h=function(c){var e,f,g;for(f=0,g=a.length;g>f;f++)e=a[f],e.timing===c&&d.meetsCriteria(e)&&d.deliver(e);b()},e.ready(g.once(function(){return e.createHead(c().get("confid")),h("asap"),h("onready")})),e.load(g.once(h,null,"onload")),d.init(),{deliver:h,isDone:function(){return b!==g.noop}}},a,d)})}.call(this),function(){a("tag-delivery",function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z;z=b("util"),e=b("config"),f=c.document,g=b("dom"),h=b("geo"),j=b("hash-set"),o=b("ns"),s=b("store"),y=b("x-frame"),b("data"),i=function(a){var b;return a&&a.nodeType?a:a&&(b=a.match(/^(head|body)$/))?f[b[1]]:f.getElementById(a)},t=new Date,t=new Date(+t+864e5),n=new Date(t.getFullYear(),t.getMonth(),t.getDate()),l=a.mode=function(){return"1"===z.param("writeCapture")?"writeCapture":"1"===z.param("writeNativeIframe")?"nativeIframe":"1"===z.param("writeOld")?"old":"newWriter"}(),a.forget=function(a){return a.metCriteria=void 0,a.time={},a},u={},z.set("tagsByName",u),w=a.uniqueName=function(a){var b,c;if(!a.named){for(c=a.name,b=1;null!=u[c];)b++,c=""+a.name+"_"+b;a.name=c,a.named=!0,u[c]=a}},x=function(a,b,d,e){var f,g,h,i,j;if(a.root=b,h=0===a.template_replacement?a.content:r(a.content),j=c.Krux,f=function(){return o.isDefault?void 0:c.Krux=o.self},g=function(){return o.isDefault?void 0:c.Krux=j},"writeCapture"===l)return c.$(b).attr("data-writeCapture","true"),c.$(b).writeCapture().html(h,{done:d});if("nativeIframe"===a.method||"native"===l&&a.target)return b.ownerDocument.write(h),d();try{return c.Krux.postscribe(b,h,{afterDequeue:f,afterStreamStart:g,done:d,error:e,name:a.name,releaseAsync:!0})}catch(k){return i=k,e(i)}},b("routes").simple("nativeTag",function(b){"native"===l&&a.deliver(z.get("tagsByName")[b])}),b("routes").simple("writeHtml",function(b,c,d){return a.deliver({name:d||"Anonymous",content:c,target:b[0]||b})}),q=function(a,b){var c,d;return d=a.target?i(a.target):g.kxhead||f.getElementsByTagName("script")[0].parentNode,d&&(c=a.target_action||"append",g[c](d,b)),d},d=function(a){var b;return b={"class":"kxtag","data-id":a.id,"data-alias":a.name},b["class"]+=a.target?" kxtargeted":" kxinvisible",b},k={eval:function(a,b,c){var d,e;e=void 0;try{e=z.globalEval(a.content)}catch(f){d=f,c(d)}return b(),e},apply:function(a,b,c){var d,e;e=void 0;try{e=a.content.apply(null)}catch(f){d=f,c(d)}return b(),e},document:function(a,b,c){var e,f;return e=g.createElement("span",d(a)),f=q(a,e),f?x(a,e,b,c):b(),e},iframeCommon:function(a,b,e,f){var h,i,j,k,l;return h=d(a),h.width=h.height=0,h.scrolling="no",h.style="overflow:hidden;",k=a.name.match(/(\d+)x(\d+)/),k&&(h.width=k[1]+"px",h.height=k[2]+"px"),i=g.createElement("iframe",h),l=q(a,i),l?(j=i.contentWindow.document,j.open(),j.write("<html><head></head><body style='margin:0;'>"),f.leaveOpen||j.close(),f.onIframe&&f.onIframe(i),i.contentWindow.Krux=c.Krux,x(a,i.contentWindow.document.body,b,e)):b(),i},nativeIframe:function(a,b,c,d){return d.leaveOpen=!0,k.iframeCommon(a,b,c,d)},iframe:function(a,b,c,d){return k.iframeCommon(a,b,c,d)}},v=a.templateData=function(){return{pubid:z.get("pubid"),site:z.get("site"),geo:h.get(),now:new Date}},r=a.runTemplate=function(a){return b("underscore").templateSettings={evaluate:/\{%([\s\S]+?)%\}/g,interpolate:/\{\{([\s\S]+?)\}\}/g,escape:/\{%-([\s\S]+?)%\}/g},z.template(a,v())},a.meetsCriteria=function(a){var c;return a.once_per_page&&p.has(a)?a.metCriteria=!1:a.criteria?"native"===l&&a.target?a.metCriteria=!1:(z.set("now",new Date),a.freq_cap&&(c="tag"+a.id+".day",y=+s.get(c)||0,z.set("tag_deliveries_today",y)),a.metCriteria=b("expression").eval(a.criteria)):a.metCriteria=!0},m=0,p=o.self._oneTimeTags=o.self._oneTimeTags||j(function(a){return a.id}),a.deliver=function(a,b){var c,d,e,f,g,h;if(g=a.once_per_page,g&&p.has(a))return p.get(a).id;b=b||{},w(a),a.id=a.id||m++,a.time={mode:"async",start:z.ms()},a.method=a.method||(z.isFunction(a.content)?"apply":"document"),"nativeIframe"===l&&a.target&&(a.method="nativeIframe"),e=function(){a.time.end=z.ms(),a.time.duration=a.time.end-a.time.start},f=function(b){a.error=b&&b.message&&b||{message:"unknown error"},z.fire("tag:fail",{id:a.id,alias:a.name,error:a.error.message})},z.fire("tag:started",{id:a.id,alias:a.name}),c=function(){var b,c;e(),a.freq_cap&&(b="tag"+a.id+".day",y=Number(s.get(b))||0,c=(n-new Date)/1e3,s.set(b,y+1,c)),z.fire("tag:done",{id:a.id,alias:a.name})};try{h=k[a.method](a,c,f,b),g&&p.put({id:a.id})}catch(i){d=i,f(d)}return h},a.claimOneTimers=function(a){var b,c,d,e;null!=a&&(d=function(){var b,c,d;for(d=[],b=0,c=a.length;c>b;b++)e=a[b],e.once_per_page&&d.push(e);return d}()),b=z.now(),c=function(){var a,c,f,g;for(f=d||[],g=[],a=0,c=f.length;c>a;a++)e=f[a],g.push({id:e.id,claimId:b});return g}(),c.length&&(y.broadcast({tags:c}),y.listen(function(a){var b,d,f,g,h,i,j,k;for(f=[],k=a.data.tags,g=0,i=k.length;i>g;g++){for(e=k[g],d=void 0,h=0,j=c.length;j>h;h++)if(b=c[h],b.id===e.id){d=b;break}e.claimId<(null!=d?d.claimId:void 0)&&f.push(e)}p.put.apply(p,f)}))},a.init=z.once(function(){b("test").module("tag-delivery",function(a){var b,c,d,e,f,g,h,i,j,k;for(h={},g=function(b){var c;return c=b.timing,a("tag_valid_timing_name",c,c),h[c]=h[c]||{lastStart:0}},k=z.get("tags"),i=0,j=k.length;j>i;i++)d=k[i],z.happened("dom:beforeunload")||z.happened("dom:unload")||a("tag_considered",null!=d.metCriteria,d.name),d.metCriteria&&(e=d.time||{},c=e.start,b=e.end,a("tag_delivered",b,d.name),f=g(d),a("tag_order",c>=f.lastStart,d.name),f.lastStart=c)})})})}.call(this),function(){a("tag",function(a,b){var c,d,e,f,g;g=b("util"),c=b("tag-actions"),d=b("tag-delivery-timing"),e=b("routes"),f=b("store"),b("data"),g.extend(a,d,{Timing:d}),a.init=function(){var a;a=f.get("org_user_id")||f.get("kuid"),a&&g.set("user",a),g.onOnce("user_data_response",function(){a=g.get("user"),a&&f.set("kuid",a)}),d(g.get("tags"))},e.regexp(/^tag:reload:?(.*)$/,function(a,b){var d,e;if(d=a[1]||c.DEFAULT,d in c)try{c[d](b)}catch(f){e=f,b(e)}else b(new TypeError("Krux('tags') has no method: "+d))})})}.call(this),function(){a("test-visualtags",function(a,b){var c,d,e,f,g,h,i,j,k;j=function(a){var b,i,j,k,l,m,n,o,p,q,r;for(l=c(".kxtargeted"),b=0,i=l.length;i>b;)q=l[b].getAttribute("data-id"),o=l[b].getAttribute("data-alias"),j=h(q),k=c("#"+j),r=1===k.length?k[0]:l[b].parentNode,p=Math.max(g("width",l[b]),f("width",r)),n=Math.max(g("height",l[b]),f("height",r)),m=p*n,a("visualtag-not-blank",m,"Tag area appears to be empty ("+o+")"),r.style&&d(r.style.width)&&a("visualtag-expected-width",e(d(r.style.width),p)<10,"Tag width ain't right ("+o+")"),r.style&&d(r.style.height)&&a("visualtag-expected-height",e(d(r.style.height),n)<10,"Tag height ain't right ("+o+")"),b++},d=function(a){return(""+a).indexOf("px")>-1?parseInt(a.replace("px",""),10)||0:0},e=function(a,b){return Math.floor(Math.abs(a-b)/b*100)},h=function(a){var b,c;
c=k.get("tagsByName");for(b in c)if(c[b].id===a)return c[b].target||"";return""},g=function(a,b){var c;return c="offset"+("width"===a?"Width":"Height"),b[c]||0},f=function(a,b){var c,d,e;if(i++,i>1e3)return 0;for(e=0,d="offset"+("width"===a?"Width":"Height"),c=0;c<b.childNodes.length;)e=Math.max(e,b.childNodes[c][d]||0),b.childNodes[c].childNodes.length&&(e=Math.max(e,f(a,b.childNodes[c]))),c++;return e},k=b("util"),c=b("sizzle").find,a.init=function(){b("test").module("visualtags",function(a){j(a)})},i=0})}.call(this),function(){var b=[].slice;a("test",function(a,c,d){var e,f,g,h,i,j,k,l;l=c("util"),h={},g="test",a.status="NOT_STARTED",k=a.test=function(b,c,d){var e;return e=c?"pass":"fail",a.results.push({module:g,code:b,data:d,assertion:c,time:new Date,status:e}),l.fire("test:"+e,{code:b,data:d}),c},f=function(a,b){return l.isArray(a)&&l.isArray(b)?a.length===b.length&&l.all(a,function(a,c){return f(a,b[c])}):a===b},k.eq=function(a,b,c){return k(a,f(b,c),{actual:b,expected:c})},e=function(){"NOT_STARTED"!==a.status&&k("tests_not_started",!1,a.status)},a.module=function(a,b){e(),h[a]=b},j=function(a,b){var c;g=a;try{b(k)}catch(d){c=d,k("tests_module_threw",!1,"module_"+a+"_threw:"+c.message)}},i=a.run=function(){var c,e,f,g,i,m,n,o,p,q,r,s,t,u;a.results=[],a.failureGroup=null,k("tests_to_run",!l.isEmpty(h));for(n in h)m=h[n],j(n,m);if(p=a.report=l.groupBy(a.results,"status"),p.total=a.results.length,p.toString=function(){var c,e,f,g,h,i,j;try{for(c=[],g=function(){var a;a=1<=arguments.length?b.call(arguments,0):[],c.push(a.join(""))},g("Test Summary: "+a.status),g("Version: "+d.Krux.version+", "+d.Krux.commit),a.failureGroup&&g("Failure Group:"+a.failureGroup),g("Phase: "+a.phase),g("Status,Code,Data"),j=a.results,h=0,i=j.length;i>h;h++)f=j[h],g(f.status,",",f.code,",",f.data);return c.join("\n")}catch(k){return e=k,"report.toString failed: "+e}},r=a.status=p.status=p.fail?"FAIL":"PASS","PASS"!==r){for(i=-1,o=void 0,e=1e3,c=[],g={tests_to_run:e--,tests_module_threw:e--,pixel:e--,tag_delivered:e--},u=p.fail,s=0,t=u.length;t>s;s++)q=u[s],f=g[q.code]||0,c.push(q.code+": "+q.data),f>i&&(i=f,o=q);a.failureGroup=o.code+(o.data?":"+o.data:""),a.phase=l.happened("dom:load")?"after_load":l.happened("dom:ready")?"after_ready_before_load":"before_ready"}l.fire("test:all_done",{status:r})},a.init=function(){var a;a=l.once(i),l.on("pixel",a),l.on("dom:beforeunload",a),l.on("dom:unload",a)}})}.call(this),function(){a("timing",function(a,b){var c,d,e;return c=b("data"),e=b("util").now,d=function(a){return function(){return c.set(a,e())}},{start:d("started"),end:d("ended")}})}.call(this),function(){var b=[].slice;a("util",function(a,c,d){var e,f,g,h,i,j,k,l;l=c("underscore"),l.extend(a,l,{_:l}),l=a,l.globalEval=function(a,b){b=b||d,a&&/\S/.test(a)&&!function(a){b.eval.call(b,a)}(a)},l.parseParams=l.parseKeyValues=function(a,b,c,d){var e,f;return b=b||"&",c=c||"=",d=d||decodeURIComponent,e={},"string"!=typeof a?e:(f=new RegExp(b+"*([^"+c+b+"]+)"+c+"([^"+b+"]+)"+b+"*","g"),a.replace(f,function(a,b,c){c=function(){try{return d(c)}catch(a){return c}}(),e[b]=e[b]?l.isArray(e[b])?e[b].concat([c]):[e[b],c]:c}),e)},l.shuffle=function(a){var b,c,d;for(b=a.length;b>0;)c=Math.floor(Math.random()*b),b--,d=[a[c],a[b]],a[b]=d[0],a[c]=d[1];return a},l.urlParams=function(a){var b;return b=(a||d.location.href).match(/[^\#?]+(?:\?([^#]*))?(?:#(.*))?/),l.parseParams(l.compact(b.slice(1)).join("&"))},l.paramString=function(a,b,c,d){var e,f,g,h,i,j;b=b||"&",c=c||"=",d=d||encodeURIComponent,f=[];for(e in a)for(h=a[e],h=l.isArray(h)?h:[h],i=0,j=h.length;j>i;i++)g=h[i],null!=g&&""!==g&&f.push(d(e)+c+d(g));return f.join(b)},l.isPrimitive=function(a){return null==a||!/^object|function$/.test(typeof a)&&!l.isNaN(a)},l.isSerializable=function(a){return l.isPrimitive(a)||!/[object [^\]]*]/.test(String(a))},l.remove=function(a,b){var c,d,e,f;if(a){for(f=[],d=0,e=a.length;e>d;d++)c=a[d],c!==b&&f.push(c);return f}},l.escapeRegexp=function(){var a,b;return b=["/",".","*","+","?","|","(",")","[","]","{","}","\\"],a=new RegExp("(\\"+b.join("|\\")+")","g"),function(b){return(""+b).replace(a,"\\$1")}}(),l.noop=function(){},l.defer=function(a){var b;b=l.rest(arguments),d.setTimeout(function(){a.apply(null,b)},0)},k=[],k.toString=function(){return d.JSON.stringify(k)},l.log=function(a){return l.isString(a)&&d.console?void 0:a?(a.time=new Date,void k.push(a)):k},l.Set=i=function(a){var b;for(b=0;b<a.length;)this[a[b]]=!0,b++},l.negate=function(a){return function(){return!a.apply(this,arguments)}},l.G=d,l.bind=function(a,b){var c,d;return a.isBound&&arguments.length<3?a:(d=l.rest(arguments,2),c=function(){return a.apply(b,d.concat(l.toArray(arguments)))},c.actual=a,c.isBound=!0,c)},l.interpolate=function(a,b){return b.replace(/\$\{([^{}]*)\}/g,function(b,c){var d;return d=a[c],"string"==typeof d||"number"==typeof d?d:b})},l.rewriter=function(a){return function(b){return a[b]||b}},l.extend(l,{max:Math.max,min:Math.min}),l.once=function(a){var b,c;return a.isOnce&&arguments.length<3?a:(b=!1,a=l.bind.apply(null,arguments),c=function(){return!b&&(b=!0)&&a.apply(null,arguments)},c.isOnce=!0,c.actual=a,c)},l.ms=function(){return new Date-l.get("started")},l.param=function(a){var b;return(b=d.location.href.match("\\bkx"+a+"(?:=|\\b)([^&\\#]*)"))&&(b[1]||!0)},l.keys=function(a){var b,c;c=[];for(b in a)c.push(b);return c},l.values=function(a){var b,c,d;switch(!1){case!(null==a):return[];case!l.isArray(a):return a.slice(0);default:d=[];for(b in a)c=a[b],d.push(c);return d}},l.attributes=function(a){var b;return b=function(a,c){var d;return d=arguments.length,0===d?b.all():l.isString(a)?1===d?b.get(a):b.set(a,c):b.set(a)},b.get=a.get,b.all=a.all,b.set=function(b,c){var d,e,f;if(null!=c)return a.set(b,c);f=[];for(d in b)e=b[d],f.push(a.set(d,e));return f},a.values&&b.set(a.values),b},l.range=function(a,b,c){var d,e,f;for(arguments.length<=1&&(b=a||0,a=0),c=arguments[2]||1,e=Math.max(Math.ceil((b-a)/c),0),d=0,f=new Array(e);e>d;)f[d++]=a,a+=c;return f},l.deref=l.dereference=function(a,b){var c,e,f,g;1===arguments.length&&(b=a,a=d);try{for(g=b.split("."),e=0,f=g.length;f>e;e++)c=g[e],a=a[c];return a}catch(h){}},l.yes=function(){return!0},l.matchAll=function(){var a,c,d,e,f;for(d=arguments[0],c=2<=arguments.length?b.call(arguments,1):[],e=0,f=c.length;f>e;e++)if(a=c[e],!(null!=a.test?a.test(d):-1!==d.indexOf(a)))return!1;return!0},l.rate=function(a){return Math.random()<=a},g=60,f=60*g,e=24*f,h=30*e,j=365*h,l.extend(a,{SECONDS:1,MINUTES:g,HOURS:f,DAYS:e,MONTHS:h,YEARS:j})})}.call(this),function(){a("uuid",function(a,b){var c;return c=b("util").now,function(){return(""+c()+Math.random()).replace(/[^\d]*/g,"")}})}.call(this),a("version",function(a){a.version="5.41.0",a.commit="881417b"}),function(){var b=function(a,b){return function(){return a.apply(b,arguments)}},c={}.hasOwnProperty,d=function(a,b){function d(){this.constructor=a}for(var e in b)c.call(b,e)&&(a[e]=b[e]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a},e=[].slice;a("whitelist",function(a,c){var f,g;return g=c("util"),f=function(a){function c(){var a;a=1<=arguments.length?e.call(arguments,0):[],this._none=b(this._none,this),this._all=b(this._all,this),this._hasMatch=b(this._hasMatch,this),this.toString=b(this.toString,this),this.allowNone=b(this.allowNone,this),this.allowAll=b(this.allowAll,this),this.allowOnly=b(this.allowOnly,this),this.put=b(this.put,this),this.has=b(this.has,this),this.get=b(this.get,this),c.__super__.constructor.apply(this,[String].concat(e.call(a)))}return d(c,a),c.ALL={toString:function(){return"ALL"}},c.NONE={toString:function(){return"NONE"}},c.prototype.get=function(a){switch(!1){case!this._all():return a;case!this._none():return null;default:return c.__super__.get.call(this,a)}},c.prototype.has=function(a){switch(!1){case!this._none():return!1;case!this._all():return!0;default:return c.__super__.has.call(this,a)||this._hasMatch(a)}},c.prototype.put=function(){var a;return a=1<=arguments.length?e.call(arguments,0):[],(this._all()||this._none())&&(this._items={}),c.__super__.put.apply(this,a)},c.prototype.allowOnly=function(){var a;return a=1<=arguments.length?e.call(arguments,0):[],this.empty(),this.put.apply(this,a)},c.prototype.allowAll=function(){return this.empty(),this._items=c.ALL,this},c.prototype.allowNone=function(){return this.empty(),this._items=c.NONE,this},c.prototype.toString=function(){return g.isSerializable(this._items)?String(this._items):c.__super__.toString.call(this)},c.prototype._hasMatch=function(a){var b,c,d;this._thunk(),d=this._items;for(c in d)if(b=d[c],null!=b.test&&g.isFunction(b.test)&&b.test(a))return!0;return!1},c.prototype._all=function(){return this._items===c.ALL},c.prototype._none=function(){return this._items===c.NONE},c}(c("hash-set").HashSet),g.extend(function(a){var b;return b=new f,a&&a!==f.ALL?a===f.NONE?b.allowNone():b.put.apply(b,arguments):b.allowAll(),b},{Whitelist:f,ALL:f.ALL,NONE:f.NONE})})}.call(this),function(){a("x-frame",function(a,b,c){var d,e,f,g,h,i;i=b("util"),e=b("dom"),g=e.d2on,d=c.location.origin,f=a.isFramed=function(){return c.top!==c},h=a.send=function(a,b,d){if(i.isFunction(a.postMessage))try{"document"in a&&a.postMessage(c.JSON.stringify(b),d)}catch(e){}},a.broadcast=function(a,b){var e,g,j,k,l;for(null==b&&(b={}),b=i.defaults(b,{container:!0,domain:d,self:!1}),e=f()?c.parent:c,b.container&&(f()||b.self)&&h(e,a,b.domain),g=e.frames,j=k=0,l=g.length-1;l>=0?l>=k:k>=l;j=l>=0?++k:--k)(g[j]!==c||b.self)&&h(g[j],a,b.domain)},a.listen=function(a,b){var e;return e=i.defaults(b||{},{origin:d,strict:!0,win:c.window}),g(e.win,"message",function(b){e.strict&&0!==String(b.origin||"").indexOf(e.origin)||a.call(this,{data:i.isString(b.data)?c.JSON.parse(b.data):b.data,event:b})})},a.init=function(a){d=a}})}.call(this),function(){function a(a,g){a=a||"",g=g||{};for(var h in b)b.hasOwnProperty(h)&&(g.autoFix&&(g["fix_"+h]=!0),g.fix=g.fix||g["fix_"+h]);var i=[],j=function(a){return"string"==typeof a?a.replace(/(&#\d{1,4};)/gm,function(a){var b=a.substring(2,a.length-1);return String.fromCharCode(b)}):a},k=function(b){a+=b},l=function(b){a=b+a},m={comment:/^<!--/,endTag:/^<\//,atomicTag:/^<\s*(script|style|noscript|iframe|textarea)[\s\/>]/i,startTag:/^</,chars:/^[^<]/},n={comment:function(){var b=a.indexOf("-->");return b>=0?{content:a.substr(4,b),length:b+3}:void 0},endTag:function(){var b=a.match(d);return b?{tagName:b[1],length:b[0].length}:void 0},atomicTag:function(){var b=n.startTag();if(b){var c=a.slice(b.length);if(c.match(new RegExp("</\\s*"+b.tagName+"\\s*>","i"))){var d=c.match(new RegExp("([\\s\\S]*?)</\\s*"+b.tagName+"\\s*>","i"));if(d)return{tagName:b.tagName,attrs:b.attrs,content:d[1],length:d[0].length+b.length}}}},startTag:function(){var b=a.match(c);if(b){var d={};return b[2].replace(e,function(a,b){var c=arguments[2]||arguments[3]||arguments[4]||f.test(b)&&b||null;d[b]=j(c)}),{tagName:b[1],attrs:d,unary:!!b[3],length:b[0].length}}},chars:function(){var b=a.indexOf("<");return{length:b>=0?b:a.length}}},o=function(){for(var b in m)if(m[b].test(a)){var c=n[b]();return c?(c.type=c.type||b,c.text=a.substr(0,c.length),a=a.slice(c.length),c):null}},p=function(a){for(var b;b=o();)if(a[b.type]&&a[b.type](b)===!1)return},q=function(){var b=a;return a="",b},r=function(){return a};return g.fix&&!function(){var b=/^(AREA|BASE|BASEFONT|BR|COL|FRAME|HR|IMG|INPUT|ISINDEX|LINK|META|PARAM|EMBED)$/i,c=/^(COLGROUP|DD|DT|LI|OPTIONS|P|TD|TFOOT|TH|THEAD|TR)$/i,d=[];d.last=function(){return this[this.length-1]},d.lastTagNameEq=function(a){var b=this.last();return b&&b.tagName&&b.tagName.toUpperCase()===a.toUpperCase()},d.containsTagName=function(a){for(var b,c=0;b=this[c];c++)if(b.tagName===a)return!0;return!1};var e=function(a){return a&&"startTag"===a.type&&(a.unary=b.test(a.tagName)||a.unary),a},f=o,h=function(){var b=a,c=e(f());return a=b,c},i=function(){var a=d.pop();l("</"+a.tagName+">")},j={startTag:function(a){var b=a.tagName;"TR"===b.toUpperCase()&&d.lastTagNameEq("TABLE")?(l("<TBODY>"),m()):g.fix_selfClose&&c.test(b)&&d.containsTagName(b)?d.lastTagNameEq(b)?i():(l("</"+a.tagName+">"),m()):a.unary||d.push(a)},endTag:function(a){var b=d.last();b?g.fix_tagSoup&&!d.lastTagNameEq(a.tagName)?i():d.pop():g.fix_tagSoup&&k()}},k=function(){f(),m()},m=function(){var a=h();a&&j[a.type]&&j[a.type](a)};o=function(){return m(),e(f())}}(),{append:k,readToken:o,readTokens:p,clear:q,rest:r,stack:i}}var b=function(){var a,b={},c=this.document.createElement("div");return a="<P><I></P></I>",c.innerHTML=a,b.tagSoup=c.innerHTML!==a,c.innerHTML="<P><i><P></P></i></P>",b.selfClose=2===c.childNodes.length,b}(),c=/^<([\-A-Za-z0-9_]+)((?:\s+[\w\-]+(?:\s*=?\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)>/,d=/^<\/([\-A-Za-z0-9_]+)[^>]*>/,e=/([\-A-Za-z0-9_]+)(?:\s*=\s*(?:(?:"((?:\\.|[^"])*)")|(?:'((?:\\.|[^'])*)')|([^>\s]+)))?/g,f=/^(checked|compact|declare|defer|disabled|ismap|multiple|nohref|noresize|noshade|nowrap|readonly|selected)$/i;a.supports=b,a.tokenToString=function(a){var b={comment:function(a){return"<--"+a.content+"-->"},endTag:function(a){return"</"+a.tagName+">"},atomicTag:function(a){return b.startTag(a)+a.content+b.endTag(a)},startTag:function(a){var b="<"+a.tagName;for(var c in a.attrs){var d=a.attrs[c];b+=" "+c+'="'+(d?d.replace(/(^|[^\\])"/g,'$1\\"'):"")+'"'}return b+(a.unary?"/>":">")},chars:function(a){return a.text}};return b[a.type](a)},a.escapeAttributes=function(a){var b={};for(var c in a){var d=a[c];b[c]=d&&d.replace(/(^|[^\\])"/g,'$1\\"')}return b};for(var g in b)a.browserHasFlaw=a.browserHasFlaw||!b[g]&&g;this.htmlParser=a}(),function(){function a(){}function b(a){return a!==m&&null!==a}function c(a){return"function"==typeof a}function d(a,b,c){var d,e=a&&a.length||0;for(d=0;e>d;d++)b.call(c,a[d],d)}function e(a,b,c){var d;for(d in a)a.hasOwnProperty(d)&&b.call(c,d,a[d])}function f(a,b){return e(b,function(b,c){a[b]=c}),a}function g(a,c){return a=a||{},e(c,function(c,d){b(a[c])||(a[c]=d)}),a}function h(a){try{return o.call(a)}catch(b){var c=[];return d(a,function(a){c.push(a)}),c}}function i(a){return a&&"tagName"in a?!!~a.tagName.toLowerCase().indexOf("script"):!1}function j(a){return a&&"tagName"in a?!!~a.tagName.toLowerCase().indexOf("style"):!1}var k={afterAsync:a,afterDequeue:a,afterStreamStart:a,afterWrite:a,beforeEnqueue:a,beforeWrite:function(a){return a},done:a,error:function(a){throw a},releaseAsync:!1},l=this,m=void 0;if(!l.postscribe){var n=!1,o=Array.prototype.slice,p=function(a){return a[a.length-1]},q=function(){function a(a,c,d){var e=k+c;if(2===arguments.length){var f=a.getAttribute(e);return b(f)?String(f):f}b(d)&&""!==d?a.setAttribute(e,d):a.removeAttribute(e)}function g(b,c){var d=b.ownerDocument;f(this,{root:b,options:c,win:d.defaultView||d.parentWindow,doc:d,parser:htmlParser("",{autoFix:!0}),actuals:[b],proxyHistory:"",proxyRoot:d.createElement(b.nodeName),scriptStack:[],writeQueue:[]}),a(this.proxyRoot,"proxyof",0)}var k="data-ps-";return g.prototype.write=function(){[].push.apply(this.writeQueue,arguments);for(var a;!this.deferredRemote&&this.writeQueue.length;)a=this.writeQueue.shift(),c(a)?this.callFunction(a):this.writeImpl(a)},g.prototype.callFunction=function(a){var b={type:"function",value:a.name||a.toString()};this.onScriptStart(b),a.call(this.win,this.doc),this.onScriptDone(b)},g.prototype.writeImpl=function(a){this.parser.append(a);for(var b,c,d,e=[];(b=this.parser.readToken())&&!(c=i(b))&&!(d=j(b));)e.push(b);this.writeStaticTokens(e),c&&this.handleScriptToken(b),d&&this.handleStyleToken(b)},g.prototype.writeStaticTokens=function(a){var b=this.buildChunk(a);if(b.actual)return b.html=this.proxyHistory+b.actual,this.proxyHistory+=b.proxy,this.proxyRoot.innerHTML=b.html,n&&(b.proxyInnerHTML=this.proxyRoot.innerHTML),this.walkChunk(),n&&(b.actualInnerHTML=this.root.innerHTML),b},g.prototype.buildChunk=function(a){var b=this.actuals.length,c=[],e=[],f=[];return d(a,function(a){if(c.push(a.text),a.attrs){if(!/^noscript$/i.test(a.tagName)){var d=b++;e.push(a.text.replace(/(\/?>)/," "+k+"id="+d+" $1")),"ps-script"!==a.attrs.id&&"ps-style"!==a.attrs.id&&f.push("atomicTag"===a.type?"":"<"+a.tagName+" "+k+"proxyof="+d+(a.unary?" />":">"))}}else e.push(a.text),f.push("endTag"===a.type?a.text:"")}),{tokens:a,raw:c.join(""),actual:e.join(""),proxy:f.join("")}},g.prototype.walkChunk=function(){for(var c,d=[this.proxyRoot];b(c=d.shift());){var e=1===c.nodeType,f=e&&a(c,"proxyof");if(!f){e&&(this.actuals[a(c,"id")]=c,a(c,"id",null));var g=c.parentNode&&a(c.parentNode,"proxyof");g&&this.actuals[g].appendChild(c)}d.unshift.apply(d,h(c.childNodes))}},g.prototype.handleScriptToken=function(a){var b=this.parser.clear();b&&this.writeQueue.unshift(b),a.src=a.attrs.src||a.attrs.SRC,a.src&&this.scriptStack.length?this.deferredRemote=a:this.onScriptStart(a);var c=this;this.writeScriptToken(a,function(){c.onScriptDone(a)})},g.prototype.handleStyleToken=function(a){var b=this.parser.clear();b&&this.writeQueue.unshift(b),a.type=a.attrs.type||a.attrs.TYPE||"text/css",this.writeStyleToken(a),b&&this.write()},g.prototype.writeStyleToken=function(a){var b=this.buildStyle(a);this.insertStyle(b),a.content&&(b.styleSheet&&!b.sheet?b.styleSheet.cssText=a.content:b.appendChild(this.doc.createTextNode(a.content)))},g.prototype.buildStyle=function(a){var b=this.doc.createElement(a.tagName);return b.setAttribute("type",a.type),e(a.attrs,function(a,c){b.setAttribute(a,c)}),b},g.prototype.insertStyle=function(a){this.writeImpl('<span id="ps-style"/>');var b=this.doc.getElementById("ps-style");b.parentNode.replaceChild(a,b)},g.prototype.onScriptStart=function(a){a.outerWrites=this.writeQueue,this.writeQueue=[],this.scriptStack.unshift(a)},g.prototype.onScriptDone=function(a){return a!==this.scriptStack[0]?void this.options.error({message:"Bad script nesting or script finished twice"}):(this.scriptStack.shift(),this.write.apply(this,a.outerWrites),void(!this.scriptStack.length&&this.deferredRemote&&(this.onScriptStart(this.deferredRemote),this.deferredRemote=null)))},g.prototype.writeScriptToken=function(a,b){var c=this.buildScript(a),d=this.shouldRelease(c),e=this.options.afterAsync;a.src&&(c.src=a.src,this.scriptLoadHandler(c,d?e:function(){b(),e()}));try{this.insertScript(c),(!a.src||d)&&b()}catch(f){this.options.error(f),b()}},g.prototype.buildScript=function(a){var b=this.doc.createElement(a.tagName);return e(a.attrs,function(a,c){b.setAttribute(a,c)}),a.content&&(b.text=a.content),b},g.prototype.insertScript=function(a){this.writeImpl('<span id="ps-script"/>');var b=this.doc.getElementById("ps-script");b.parentNode.replaceChild(a,b)},g.prototype.scriptLoadHandler=function(a,b){function c(){a=a.onload=a.onreadystatechange=a.onerror=null}function d(){c(),b()}function e(a){c(),g(a),b()}var g=this.options.error;f(a,{onload:function(){d()},onreadystatechange:function(){/^(loaded|complete)$/.test(a.readyState)&&d()},onerror:function(){e({message:"remote script failed "+a.src})}})},g.prototype.shouldRelease=function(a){var b=/^script$/i.test(a.nodeName);return!b||!!(this.options.releaseAsync&&a.src&&a.hasAttribute("async"))},g}();l.postscribe=function(){function b(){var a,b=j.shift();b&&(a=p(b),a.afterDequeue(),b.stream=d.apply(null,b),a.afterStreamStart())}function d(c,d,g){function j(a){a=g.beforeWrite(a),m.write(a),g.afterWrite(a)}m=new q(c,g),m.id=i++,m.name=g.name||m.id,e.streams[m.name]=m;var k=c.ownerDocument,l={close:k.close,open:k.open,write:k.write,writeln:k.writeln};f(k,{close:a,open:a,write:function(){return j(h(arguments).join(""))},writeln:function(){return j(h(arguments).join("")+"\n")}});var n=m.win.onerror||a;return m.win.onerror=function(a,b,c){g.error({msg:a+" - "+b+":"+c}),n.apply(m.win,arguments)},m.write(d,function(){f(k,l),m.win.onerror=n,g.done(),m=null,b()}),m}function e(d,e,f){c(f)&&(f={done:f}),f=g(f,k),d=/^#/.test(d)?l.document.getElementById(d.substr(1)):d.jquery?d[0]:d;var h=[d,e,f];return d.postscribe={cancel:function(){h.stream?h.stream.abort():h[1]=a}},f.beforeEnqueue(h),j.push(h),m||b(),d.postscribe}var i=0,j=[],m=null;return f(e,{streams:{},queue:j,WriteStream:q})}()}}(),b("index")}();